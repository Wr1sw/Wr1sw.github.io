<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Oracle复习2</title>
    <url>/2021/11/11/Oracle%E5%A4%8D%E4%B9%A02/</url>
    <content><![CDATA[<h3 id="数据库对象——简介"><a href="#数据库对象——简介" class="headerlink" title="数据库对象——简介"></a>数据库对象——简介</h3><h4 id="1-1-Oracle服务器的方案对象和非方案对象的概念"><a href="#1-1-Oracle服务器的方案对象和非方案对象的概念" class="headerlink" title="1.1 Oracle服务器的方案对象和非方案对象的概念"></a>1.1 Oracle服务器的方案对象和非方案对象的概念</h4><h5 id="1-1-1-方案"><a href="#1-1-1-方案" class="headerlink" title="1.1.1 方案"></a>1.1.1 方案</h5><p>​    Oracle通过方案来组织和维护表、视图、索引、等数据库对象</p>
<ul>
<li><p>概念：是一系列逻辑数据结构或对象的集合。一个方案只能够被一个数据库用户所拥有，并且方案的名称与这个用户的名称相同。</p>
</li>
<li><p>Oracle数据库中的每个用户都拥有一个唯一的方案，他所创建的所有方案对象都保存在自己的方案中</p>
</li>
</ul>
<h5 id="1-1-2-方案对象"><a href="#1-1-2-方案对象" class="headerlink" title="1.1.2 方案对象"></a>1.1.2 方案对象</h5><p>​    在Oracle数据库中不是所有对象都是方案。方案对象有：</p>
<p><img src="1-1-2.png"></p>
<h5 id="1-1-3-非方案对象的类型"><a href="#1-1-3-非方案对象的类型" class="headerlink" title="1.1.3 非方案对象的类型"></a>1.1.3 非方案对象的类型</h5><p>在Oracle数据库中不是所有的对象都是方案，还有一些数据库对象不属于任何方案，这些对象称为<strong>非方案对象</strong>，其类型有：</p>
<ul>
<li>表空间 Tablespaces</li>
<li>用户 Users</li>
<li>角色 Roles</li>
<li>回退段 Rollback segments</li>
<li>目录 Directories</li>
</ul>
<p><img src="1-1-3.png"></p>
<h5 id="1-2-表、视图、索引、序列等数据库对象的声明和创建方法"><a href="#1-2-表、视图、索引、序列等数据库对象的声明和创建方法" class="headerlink" title="1.2 表、视图、索引、序列等数据库对象的声明和创建方法"></a>1.2 表、视图、索引、序列等数据库对象的声明和创建方法</h5><h6 id="1-2-1-表"><a href="#1-2-1-表" class="headerlink" title="1.2.1 表"></a>1.2.1 表</h6><ul>
<li>表是Oracle数据库中基本的数据库存储结构。在定义表时为表建立多个字段，数据以行的记录的形式存储在表中。</li>
</ul>
<p><img src="1-2-1.png"></p>
<p>字段约束：在创建表时，可对表的各个字段设置约束，强制规定表中的数据必须满足的条件。通过使用约束可以保证关系数据库中的三类完整性规则：</p>
<ul>
<li>实体完整性</li>
<li>参照完整性</li>
<li>用户定义完整性</li>
</ul>
<p>NULL值：在Oracle表中，某个字段可以不包含任何值，则称该字段具有“NULL”值</p>
<p>数据完整性约束：数据完整性约束使用户定义的一系列规则，用于防止错误的或无效的数据被插入或删除。在Oracle中，一共可以为表中的字段定义如下五种类型的约束：</p>
<ul>
<li>PRIMARY KEY 主码约束</li>
<li>NOT NULL 非空约束</li>
<li>UNIQUE 唯一码约束</li>
<li>FOREIGN KEY 外键(外部码)约束</li>
<li>CHECK 约束</li>
</ul>
<h6 id="1-2-2-视图"><a href="#1-2-2-视图" class="headerlink" title="1.2.2 视图"></a>1.2.2 视图</h6><ul>
<li><strong>视图</strong>是由一个或多个表（或其他视图）中的数据的一种定制的表示，是用一个查询定义，所以可认为是一个存储的查询（stored query）或是一个虚表(virtual table)。视图可在使用表的许多地方使用。</li>
<li>引入<strong>视图的好处</strong><ul>
<li>通过限制对表的行预定义集合的存取，为表提供附加的<strong>安全性</strong></li>
<li>隐藏数据<strong>复杂性</strong></li>
<li>为用户<strong>简化命令</strong></li>
<li>为基本表的数据提供另一种观点</li>
<li>可将应用隔离基本表定义的修改</li>
<li>用于不用视图无法表示的查询</li>
<li>用于<strong>保存复杂查询</strong></li>
</ul>
</li>
</ul>
<p>创建视图(以EMP为基础表创建STAFF视图)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> staff <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename,job,mgr,deptno  <span class="keyword">FROM</span> emp</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="1-2-2.png"></p>
<ul>
<li><p>创建视图（以EMP和DEPT为基础表创建EMP_VIEW视图）</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> emp_view <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename, sal, loc</span><br><span class="line"><span class="keyword">FROM</span> emp, dept</span><br><span class="line"><span class="keyword">WHERE</span> emp.deptno <span class="operator">=</span> dept.deptno <span class="keyword">AND</span>  dept.deptno <span class="operator">=</span> <span class="number">10</span></span><br></pre></td></tr></table></figure></li>
<li><p>查询EMP_VIEW视图</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ename  <span class="keyword">FROM</span> emp_view  <span class="keyword">WHERE</span> empno <span class="operator">=</span> <span class="number">9876</span></span><br></pre></td></tr></table></figure></li>
<li><p>Oracle将上述查询语句合并为如下查询语句</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ename  <span class="keyword">FROM</span> emp, dept</span><br><span class="line"><span class="keyword">WHERE</span> emp.deptno <span class="operator">=</span> dept.deptno  <span class="keyword">AND</span>  dept.deptno <span class="operator">=</span> <span class="number">10</span></span><br><span class="line"><span class="keyword">AND</span>  emp.empno <span class="operator">=</span> <span class="number">9876</span></span><br></pre></td></tr></table></figure></li>
<li><p>重定义视图</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> emp_view <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> empno, ename, sal, loc</span><br><span class="line"><span class="keyword">FROM</span> emp, dept</span><br><span class="line"><span class="keyword">WHERE</span> emp.deptno <span class="operator">=</span> dept.deptno;</span><br></pre></td></tr></table></figure></li>
<li><p>删除视图</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> emp_view;</span><br></pre></td></tr></table></figure></li>
</ul>
<h6 id="1-2-3-索引"><a href="#1-2-3-索引" class="headerlink" title="1.2.3 索引"></a>1.2.3 索引</h6><p><img src="1-3-1.png"></p>
<h6 id="1-2-4-序列"><a href="#1-2-4-序列" class="headerlink" title="1.2.4 序列"></a>1.2.4 序列</h6><ul>
<li><p>序列：序列也称序列生成器(sequence generator)产生序列号。在多用户环境下该序列生成器特别有用，可生成各返回序列号而不需要磁盘I/O或事务封锁。</p>
</li>
<li><p>•序列号为ORACLE整数，最多可有<strong>38</strong>个数字。</p>
</li>
<li><p>序列的创建</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> SEQUENCE project_team_seq</span><br><span class="line">               <span class="keyword">START</span> <span class="keyword">WITH</span> <span class="number">1000</span> INCREMENT <span class="keyword">BY</span> <span class="number">1</span></span><br><span class="line">               MINVALUE <span class="number">1</span></span><br><span class="line">               CACHE <span class="number">1000</span> NOCYCLE NOORDER</span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span><span class="operator">/</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> project_team_seq.NEXTVAL <span class="keyword">FROM</span> DUAL;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="1-2-4-同义词"><a href="#1-2-4-同义词" class="headerlink" title="1.2.4 同义词"></a>1.2.4 同义词</h6></li>
<li><p>一个同义词(synonym)为任何表、视图、快照、序列、过程、函数或包的别名，其定义存储在数据字典中。同义词因安全性和方便原因而经常使用，可用于：</p>
<ul>
<li>可屏蔽对象的名字及其持有者。</li>
<li>为分布式数据库的远程对象提供位置透明性。</li>
<li>为用户提供一个简单且易于区分的名字。</li>
</ul>
</li>
<li><p>有两种同义词：公用和专用</p>
<ul>
<li>一个公用同义词为命名为PUBLIC特殊用户组所持有，可为数据库中每一个用户所存取。</li>
<li>一个专用同义词是包含在指定用户的方案中，仅为该用户和授权的用户所使用。</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 私有同义词</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> SYNONYM SALG <span class="keyword">FOR</span> SCOTT.SALGRADE</span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span><span class="operator">/</span></span><br><span class="line"><span class="comment">-- 共有同义词</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> PUBLIC SYNONYM P_SALG <span class="keyword">FOR</span> SCOTT.SALGRADE</span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span><span class="operator">/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="1-2-5-角色"><a href="#1-2-5-角色" class="headerlink" title="1.2.5 角色"></a>1.2.5 角色</h6><p><img src="1-2-5.png"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 创建、删除角色</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> ROLE oe_clerk;</span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> ROLE hr_clerk</span><br><span class="line">			IDENTIFIED <span class="keyword">BY</span> bonus;</span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> ROLE hr_manager</span><br><span class="line">			IDENTIFIED EXTERNALLY;</span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">DROP</span> ROLE oe_clerk;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h6 id="1-2-6-用户"><a href="#1-2-6-用户" class="headerlink" title="1.2.6 用户"></a>1.2.6 用户</h6><ul>
<li><p>创建、删除用户</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> user_name</span><br><span class="line">IDENTIFIED <span class="keyword">BY</span> password</span><br><span class="line">[<span class="keyword">DEFAULT</span> TABLESPACE tablespace_name]</span><br><span class="line">[TEMPORARY TABLESPACE tablespace_name]</span><br><span class="line">[QUOTA quota_number [K <span class="operator">|</span> M] <span class="operator">|</span> UNLIMITED <span class="keyword">ON</span> tablespace_name]</span><br><span class="line">[PROFILE profile_name]</span><br><span class="line">[PASSWORD expire]</span><br><span class="line">[ACCOUNT lock<span class="operator">|</span> unlock] </span><br></pre></td></tr></table></figure>

<p><img src="1-2-6.png"></p>
</li>
<li><p>命令解释 </p>
<ul>
<li>CREATE USER username —用户名</li>
<li>IDENTIFIED BY password—- 用户口令</li>
<li>[DEFAULT TABLESPACE tablespace ]— 缺省的表空间,该用户创建的对象默认存在此。</li>
<li>[TEMPORARY TABLESPACE tablespace] —该用户使用的缺省的临时表空间</li>
<li>[[QUOTA [integer K[M]][UNLIMITED] ON tablespace —用户在该表空间中允许使用k[m]字节</li>
<li>[PROFILES profile_name] —概要文件的名字</li>
<li>[PASSWORD EXPIRE] —立即将口令设成过期状态，用户在登录进入前必须修改口令。</li>
<li>[ACCOUNT LOCK or ACCOUNT UNLOCK] —用户是否被加锁</li>
</ul>
</li>
<li><p>启用与禁用用户</p>
<ul>
<li>禁用用户账户      ALTER USER user_name ACCOUNT LOCK;</li>
<li>启用用户账户      ALTER USER user_name ACCOUNT UNLOCK;</li>
</ul>
</li>
<li><p>删除用户 </p>
<ul>
<li><p>DROP USER user_name [CASCADE] </p>
</li>
<li><p>如果该用户方案中已存在方案对象，则需要带有CASCADE子句。 </p>
</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例1  创建新用户zhangsan，密码为abcdef，命令如下。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> zhangsan</span><br><span class="line">IDENTIFIED <span class="keyword">BY</span> abcdef;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例2  创建新用户lisi，密码为abcdef，表空间为users，并且在users表空间上可以使-- 用10M的磁盘空间。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> lisi  IDENTIFIED <span class="keyword">BY</span> abcdef</span><br><span class="line"><span class="keyword">DEFAULT</span> TABLESPACE users</span><br><span class="line">QUOTA <span class="number">10</span>M <span class="keyword">ON</span> users; </span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例3  创建新用户allen，密码为abcdef，并且设置密码已过期，用户的状态为加锁。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> allen</span><br><span class="line">IDENTIFIED <span class="keyword">BY</span> abcdef</span><br><span class="line">PASSWORD expire</span><br><span class="line">ACCOUNT lock; </span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例4  为新用户zhangsan授予和数据库建立会话的权限，并用zhangsan连接数据库。</span></span><br><span class="line"><span class="comment">--在授权之前，用zhangsan连接数据库的操作失败</span></span><br><span class="line"><span class="keyword">CONNECT</span> zhangsan<span class="operator">/</span>abcdef; </span><br><span class="line"><span class="comment">--以system连接数据库，并使用GRANT命令为新用户授权</span></span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">system</span><span class="operator">/</span>abcdef;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">CREATE</span> SESSION <span class="keyword">TO</span> zhangsan;</span><br><span class="line"><span class="comment">--授权后，再用zhangsan连接数据库，操作成功</span></span><br><span class="line"><span class="keyword">CONNECT</span> zhangsan<span class="operator">/</span>abcdef; </span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例5  为新用户lisi授予CONNECT的角色。</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">CONNECT</span> <span class="keyword">TO</span> lisi;</span><br><span class="line"><span class="keyword">CONNECT</span> lisi<span class="operator">/</span>abcdef;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例6  修改用户zhangsan的密码为ora，并设置默认表空间为users表空间，在该表空间中可以使用无限大的磁盘空间。</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> zhangsan</span><br><span class="line">IDENTIFIED <span class="keyword">BY</span> ora</span><br><span class="line"><span class="keyword">DEFAULT</span> TABLESPACE users</span><br><span class="line">QUOTA UNLIMITED <span class="keyword">ON</span> users; </span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例7  为数据库中用户账号scott解锁，启用该账号。</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> scott ACCOUNT UNLOCK;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CONNECT</span> scott<span class="operator">/</span>tiger;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例8  删除用户zhangsan。</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> zhangsan;</span><br></pre></td></tr></table></figure>



<h5 id="1-3-数据库对象在数据库中的存储结构"><a href="#1-3-数据库对象在数据库中的存储结构" class="headerlink" title="1.3 数据库对象在数据库中的存储结构"></a>1.3 数据库对象在数据库中的存储结构</h5>]]></content>
      <categories>
        <category>Oracle</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>Oracle复习3</title>
    <url>/2021/11/11/Oracle%E5%A4%8D%E4%B9%A03/</url>
    <content><![CDATA[<h3 id="表"><a href="#表" class="headerlink" title="表"></a>表</h3><h5 id="Oracle-SQL种类"><a href="#Oracle-SQL种类" class="headerlink" title="Oracle SQL种类"></a>Oracle SQL种类</h5><ul>
<li><p><strong>数据定义语言 Data Definition Language Statements（DDL）</strong></p>
</li>
<li><p><strong>数据操纵语言 Data Manipulation Language（DML） Statements</strong></p>
</li>
<li><p>事务控制 Transaction Control Statements </p>
</li>
<li><p>会话控制 Session Control Statements </p>
</li>
<li><p>系统控制 System Control Statements </p>
</li>
<li><p>嵌入SQL Embedded SQL Statements</p>
</li>
</ul>
<h5 id="DDL"><a href="#DDL" class="headerlink" title="DDL"></a>DDL</h5><ul>
<li><p>Create、alter和drop方案对象与数据库结构 (CREATE, ALTER, DROP)</p>
</li>
<li><p>改变方案对象名称 (RENAME) </p>
</li>
<li><p>TRUNCATE</p>
</li>
<li><p>权限和角色的授予与回收 (GRANT, REVOKE) </p>
</li>
<li><p>打开与关闭审计操作 (AUDIT, NOAUDIT)</p>
</li>
<li><p>增加注释到数据字典 (COMMENT) </p>
</li>
<li><p><strong>当用户执行DDL语句时，在每一条DDL语句执行前后，Oracle都将提交当前的事务，理解这一点很重要。</strong></p>
</li>
</ul>
<p><img src="1-1.png"></p>
<h5 id="表的命名规定"><a href="#表的命名规定" class="headerlink" title="表的命名规定"></a>表的命名规定</h5><ol>
<li><strong>必须是以字母开头。</strong></li>
<li>1-30个字符长度</li>
<li><strong>仅能包括A-Z，a-z，0-9，_,$,#</strong></li>
<li>在同一个用户下表明不能重复</li>
<li>不能是Oracle保留字</li>
</ol>
<h5 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h5><p><img src="1-2.png"></p>
<h5 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h5><p>创建者必须具有</p>
<ul>
<li><p>CREATE TABLE 权限</p>
</li>
<li><p>一个存储区</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [schema.]tablename  </span><br><span class="line">             (columnname datatype [<span class="keyword">DEFAULT</span> expr][, 			...]);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>数据库表名</p>
</li>
<li><p>定义列（名称、数据类型、长度和缺省值）</p>
</li>
</ul>
<h5 id="列的缺省值"><a href="#列的缺省值" class="headerlink" title="列的缺省值"></a>列的缺省值</h5><ul>
<li>指定列的缺省值， 在以后的INSERT语句中忽略该列值时， 将此缺省值赋给该列。</li>
<li>默认值的数据类型必须和列的数据类型匹配</li>
<li>表达式、SQL函数和数值都是合法的值</li>
<li>不能包括其他列和伪列的引用（ROWNUM，NEXTVAL，LEVEL和CURRVAL）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line">	deptno number(<span class="number">2</span>),</span><br><span class="line">	dname varchar2(<span class="number">14</span>),</span><br><span class="line">	loc varchar2(<span class="number">13</span>));</span><br><span class="line">	</span><br><span class="line"><span class="comment">-- Table created</span></span><br><span class="line"><span class="keyword">describe</span> dept</span><br><span class="line"></span><br><span class="line"><span class="comment">-- NAME                NULL?       Type</span></span><br><span class="line">_____________________________________________</span><br><span class="line">DEPTNO                 <span class="keyword">NOT</span> <span class="keyword">NULL</span>     NUMBER(<span class="number">2</span>)</span><br><span class="line">DNAME                               VARCHAR2(<span class="number">14</span>)</span><br><span class="line">LOC                                 VARCHAR2(<span class="number">13</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="使用子查询创建表"><a href="#使用子查询创建表" class="headerlink" title="使用子查询创建表"></a>使用子查询创建表</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 语法</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">table</span></span><br><span class="line">  	  [<span class="keyword">column</span>(, column...)]</span><br><span class="line"><span class="keyword">AS</span> subquery;</span><br><span class="line"></span><br><span class="line"><span class="comment">--------------------------</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept30 </span><br><span class="line">	<span class="keyword">as</span> </span><br><span class="line">		<span class="keyword">select</span> empno, ename, sal<span class="operator">*</span><span class="number">12</span> annsal, hiredate</span><br><span class="line">		<span class="keyword">from</span> emp</span><br><span class="line">		<span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h5 id="更改表"><a href="#更改表" class="headerlink" title="更改表"></a>更改表</h5><ol>
<li><p>增加或删除列</p>
</li>
<li><p>增加完整性约束</p>
</li>
<li><p>重新定义列（数据类型、长度、缺省值）</p>
</li>
<li><p>修改存储参数或其它参数</p>
</li>
<li><p>使能、使不能或删除一完整性约束或触发器</p>
</li>
<li><p>显式地分配一个范围</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="keyword">table</span></span><br><span class="line"><span class="keyword">ADD</span>		   (<span class="keyword">column</span> datatype [<span class="keyword">DEFAULT</span> expr]</span><br><span class="line">		   [, <span class="keyword">column</span> datatype]...);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> DEPT30</span><br><span class="line">	<span class="keyword">ADD</span> (job VARCHAR2(<span class="number">9</span>));</span><br></pre></td></tr></table></figure>

<p><img src="1-3.png"></p>
<hr>
<h5 id="改变表名称"><a href="#改变表名称" class="headerlink" title="改变表名称"></a>改变表名称</h5><ul>
<li><p>执行RENAME语句，将改变表、视图、序列和同义词的名称。</p>
</li>
<li><p>操作者必须是对象的拥有者。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">RENAME dept <span class="keyword">TO</span> department;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h5 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h5><ul>
<li>删除表的所有数据和结构</li>
<li>删除表的所有索引</li>
<li>表的删除操作不能回退</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">TABLE</span> dept30;</span><br><span class="line"><span class="keyword">Table</span> dropped.</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>如果在要删除的表中包含有被其它表的外部码引用的主码或唯一码，并且希望在删除这个表的同时删除其它表中的相关的外部码约束，可以在DROP TABLE语句中指定CASCADE字句</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> department CASCADE CONSTRAINTS;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h5 id="截断表"><a href="#截断表" class="headerlink" title="截断表"></a>截断表</h5><ul>
<li>删除表的所有数据</li>
<li>释放被表使用的存储空间</li>
<li>截断操作不能回退</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> department;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="添加注释"><a href="#添加注释" class="headerlink" title="添加注释"></a>添加注释</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">TABLE</span> emp</span><br><span class="line">	<span class="keyword">is</span> <span class="string">&#x27;Employee Information&#x27;</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="创建约束和管理约束"><a href="#创建约束和管理约束" class="headerlink" title="创建约束和管理约束"></a>创建约束和管理约束</h5><p>约束类型</p>
<ul>
<li>NOT NULL</li>
<li>UNIQUE</li>
<li>PRIMARY KEY</li>
<li>FOREIGN KEY</li>
<li>CHECK</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 定义约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [schema.]<span class="keyword">table</span></span><br><span class="line">	    (<span class="keyword">column</span> datatype [<span class="keyword">DEFAULT</span> expr]</span><br><span class="line">		[column_constraint],</span><br><span class="line">		…</span><br><span class="line">		[table_constraint]);</span><br><span class="line">		</span><br><span class="line"><span class="comment">------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp(</span><br><span class="line">	empno NUMBER(<span class="number">4</span>),</span><br><span class="line">	ename VARCHAR2(<span class="number">10</span>),</span><br><span class="line">	deptno NUMBER(<span class="number">7</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>, </span><br><span class="line">	<span class="keyword">CONSTRAINT</span> emp_empno_pk <span class="keyword">PRIMARY</span> KEY(EMPNO));</span><br><span class="line">	</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 唯一码约束</span></span><br><span class="line"><span class="comment">-- 唯一码约束可以定义在列上或者表上(unique)</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span>   dept(</span><br><span class="line">    	deptno 	  NUMBER(<span class="number">2</span>),</span><br><span class="line">  		dname	  VARCHAR2(<span class="number">14</span>),</span><br><span class="line">  		loc	  VARCHAR2(<span class="number">13</span>),</span><br><span class="line">  		<span class="keyword">CONSTRAINT</span> dept_dname_uk <span class="keyword">UNIQUE</span>(dname));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 主键约束</span></span><br><span class="line"><span class="comment">-- 主键越是可以定义在列上或者表上（PRIMARY KEY）</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span>   dept(</span><br><span class="line">    	deptno 	  NUMBER(<span class="number">2</span>),</span><br><span class="line">  		dname	  VARCHAR2(<span class="number">14</span>),</span><br><span class="line"> 		loc	  	  VARCHAR2(<span class="number">13</span>),</span><br><span class="line">  		<span class="keyword">CONSTRAINT</span> dept_dname_uk <span class="keyword">UNIQUE</span> (dname),</span><br><span class="line">  		<span class="keyword">CONSTRAINT</span> dept_deptno_pk <span class="keyword">PRIMARY</span> KEY(deptno) );</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 外键约束</span></span><br><span class="line"><span class="comment">-- 外键约束可以定义在列上或者表上（FOREIGN KEY）</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp(</span><br><span class="line">    	empno 	NUMBER(<span class="number">4</span>),</span><br><span class="line">  		ename	VARCHAR2(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  		job	VARCHAR2(<span class="number">9</span>),</span><br><span class="line">  		mgr	NUMBER(<span class="number">4</span>),</span><br><span class="line">  		hiredate	<span class="type">DATE</span>,</span><br><span class="line">  		sal	NUMBER(<span class="number">7</span>,<span class="number">2</span>),</span><br><span class="line">   		comm	NUMBER(<span class="number">7</span>,<span class="number">2</span>),</span><br><span class="line">		deptno	NUMBER(<span class="number">7</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> 		<span class="keyword">CONSTRAINT</span> emp_deptno_fk <span class="keyword">FOREIGN</span> KEY (deptno)</span><br><span class="line"> 			<span class="keyword">REFERENCES</span> dept (deptno));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- check约束：定义表的每一行必须满足的条件</span></span><br><span class="line">..., deptno	NUMBER(<span class="number">2</span>),</span><br><span class="line">      <span class="keyword">CONSTRAINT</span> emp_deptno_ck  </span><br><span class="line">            <span class="keyword">CHECK</span> (DEPTNO <span class="keyword">BETWEEN</span> <span class="number">10</span> <span class="keyword">AND</span> <span class="number">99</span>),...</span><br></pre></td></tr></table></figure>

<p><strong>可以增加和删除约束但是不能修改约束</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span>	 <span class="keyword">table</span></span><br><span class="line">  <span class="keyword">ADD</span> [<span class="keyword">CONSTRAINT</span> <span class="keyword">constraint</span>] type (<span class="keyword">column</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p><strong>删除</strong>在表DEPT上的<strong>PRIMARY KEY</strong>约束并且删除在表EMP的DEPTNO列上的<strong>FOREIGN KEY</strong>约束</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span>     emp</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span>  emp_mgr_fk </span><br><span class="line">  <span class="number">3</span>  		<span class="keyword">FOREIGN</span> KEY(mgr) <span class="keyword">REFERENCES</span> emp(empno);</span><br><span class="line"><span class="keyword">Table</span> altered.</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span>	  emp</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span>  emp_mgr_fk;</span><br><span class="line"><span class="keyword">Table</span> altered.</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span>	dept</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">DROP</span> <span class="keyword">PRIMARY</span> KEY CASCADE;</span><br><span class="line"><span class="keyword">Table</span> altered.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p>禁用和启用约束</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- </span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span>		emp</span><br><span class="line">  <span class="number">2</span>  ENABLE <span class="keyword">CONSTRAINT</span>	emp_empno_pk;</span><br><span class="line"><span class="keyword">Table</span> altered.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span>		emp</span><br><span class="line">  <span class="number">2</span>  DISABLE <span class="keyword">CONSTRAINT</span>	emp_empno_pk CASCADE;</span><br><span class="line"><span class="keyword">Table</span> altered.</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>Oracle</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>Oracle复习4</title>
    <url>/2021/11/11/Oracle%E5%A4%8D%E4%B9%A04/</url>
    <content><![CDATA[<h3 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h3><h5 id="INSERT语法"><a href="#INSERT语法" class="headerlink" title="INSERT语法"></a>INSERT语法</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>	<span class="keyword">table</span> [(<span class="keyword">column</span> [, column...])]</span><br><span class="line"><span class="keyword">VALUES</span>		(<span class="keyword">value</span> [, value...]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span>	dept (deptno, dname, loc)</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">VALUES</span>		(<span class="number">50</span>, <span class="string">&#x27;DEVELOPMENT&#x27;</span>, <span class="string">&#x27;DETROIT&#x27;</span>);</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> created.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="插入NULL值"><a href="#插入NULL值" class="headerlink" title="插入NULL值"></a>插入NULL值</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">VALUES</span>		(<span class="number">70</span>, <span class="string">&#x27;FINANCE&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> created.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="插入SYSDATE函数值，SYSDATE函数返回当前的日期和时间。"><a href="#插入SYSDATE函数值，SYSDATE函数返回当前的日期和时间。" class="headerlink" title="插入SYSDATE函数值，SYSDATE函数返回当前的日期和时间。"></a>插入SYSDATE函数值，SYSDATE函数返回当前的日期和时间。</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp (empno, ename, job,</span><br><span class="line">  <span class="number">2</span>			mgr, hiredate, sal, comm,</span><br><span class="line">  <span class="number">3</span>			deptno)</span><br><span class="line">  <span class="number">4</span>  <span class="keyword">VALUES</span>		(<span class="number">7196</span>, <span class="string">&#x27;GREEN&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>,</span><br><span class="line">  <span class="number">5</span>			<span class="number">7782</span>, SYSDATE, <span class="number">2000</span>, <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="number">6</span>			<span class="number">10</span>);</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> created.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="插入多行数据"><a href="#插入多行数据" class="headerlink" title="插入多行数据"></a>插入多行数据</h5><p><strong>注意：不能使用VALUES子句</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> managers(id, name, salary, hiredate)</span><br><span class="line">  <span class="number">2</span>          		<span class="keyword">SELECT</span>	empno, ename, sal, hiredate</span><br><span class="line">  <span class="number">3</span>          		<span class="keyword">FROM</span>   emp</span><br><span class="line">  <span class="number">4</span>          		<span class="keyword">WHERE</span>	job <span class="operator">=</span> <span class="string">&#x27;MANAGER&#x27;</span>;</span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> created.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h3><h5 id="UPDATE语法"><a href="#UPDATE语法" class="headerlink" title="UPDATE语法"></a>UPDATE语法</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">UPDATE		<span class="keyword">table</span></span><br><span class="line"><span class="keyword">SET</span>		<span class="keyword">column</span> <span class="operator">=</span> <span class="keyword">value</span> [, <span class="keyword">column</span> <span class="operator">=</span> <span class="keyword">value</span>]</span><br><span class="line">[<span class="keyword">WHERE</span> 		<span class="keyword">condition</span>];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="更新所有行的数据"><a href="#更新所有行的数据" class="headerlink" title="更新所有行的数据"></a>更新所有行的数据</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> UPDATE 	emp</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">SET</span>    	deptno <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> updated.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="更新指定行的数据"><a href="#更新指定行的数据" class="headerlink" title="更新指定行的数据"></a>更新指定行的数据</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> UPDATE 	emp</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">SET</span>    	deptno <span class="operator">=</span> <span class="number">20</span></span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>  	empno <span class="operator">=</span> <span class="number">7782</span>;</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> updated.</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="使用子查询更新行的多列数据"><a href="#使用子查询更新行的多列数据" class="headerlink" title="使用子查询更新行的多列数据"></a>使用子查询更新行的多列数据</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> UPDATE  emp</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">SET</span>     (job, deptno) <span class="operator">=</span> </span><br><span class="line">  <span class="number">3</span>	 		    (<span class="keyword">SELECT</span> job, deptno</span><br><span class="line">  <span class="number">4</span>                          <span class="keyword">FROM</span>    emp</span><br><span class="line">  <span class="number">5</span>                          <span class="keyword">WHERE</span>   empno <span class="operator">=</span> <span class="number">7499</span>)</span><br><span class="line">  <span class="number">6</span>  <span class="keyword">WHERE</span>   empno <span class="operator">=</span> <span class="number">7698</span>;</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> updated.</span><br></pre></td></tr></table></figure>



<h5 id="使用子查询更新行数据"><a href="#使用子查询更新行数据" class="headerlink" title="使用子查询更新行数据"></a>使用子查询更新行数据</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">UPDATE	employee</span><br><span class="line">   	<span class="keyword">SET</span>	deptno <span class="operator">=</span>  (<span class="keyword">SELECT</span>	deptno</span><br><span class="line">   			<span class="keyword">FROM</span>	emp 	</span><br><span class="line">   			<span class="keyword">WHERE</span>	empno <span class="operator">=</span> <span class="number">7788</span>)</span><br><span class="line">   	<span class="keyword">WHERE</span>	job    <span class="operator">=</span>  (<span class="keyword">SELECT</span>	job</span><br><span class="line">   			<span class="keyword">FROM</span>	emp</span><br><span class="line">   			<span class="keyword">WHERE</span>	empno <span class="operator">=</span> <span class="number">7788</span>);</span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> updated.</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><p><img src="1-1.png"></p>
<hr>
<h3 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h3><h5 id="select语法"><a href="#select语法" class="headerlink" title="select语法"></a>select语法</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>		[<span class="keyword">DISTINCT</span>] &#123;<span class="operator">*</span>, <span class="keyword">column</span> [alias], ...&#125;</span><br><span class="line"><span class="keyword">FROM</span> 		<span class="keyword">table</span></span><br><span class="line">[<span class="keyword">WHERE</span>		<span class="keyword">condition</span>(s)]</span><br><span class="line">[<span class="keyword">ORDER</span> <span class="keyword">BY</span>	&#123;<span class="keyword">column</span>, expr, alias&#125; [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>]];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>SELECT 后定义用户需要检索的信息。</p>
</li>
<li><p>FROM 后定义检索的对象。</p>
</li>
<li><p>SQL语句不区分大小写。</p>
</li>
<li><p>SQL语句可以是一行或多行。</p>
</li>
<li><p>子句通常单独一行。</p>
</li>
<li><p>使用缩近提高可读性。</p>
</li>
</ul>
<h5 id="查询所有的列和行"><a href="#查询所有的列和行" class="headerlink" title="查询所有的列和行"></a><strong><strong>查询所有的列和行</strong></strong></h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span> 	dept;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="查询指定的列和所有行"><a href="#查询指定的列和所有行" class="headerlink" title="查询指定的列和所有行"></a>查询指定的列和所有行</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> deptno, loc</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>   dept;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="NULL值"><a href="#NULL值" class="headerlink" title="NULL值"></a>NULL值</h5><ul>
<li>NULL值：NULL是一个<strong>值</strong>，它和“0”、“空白”不一样。</li>
</ul>
<p><img src="1-2.png"></p>
<ul>
<li><p>如果算术表达式中包括NULL值，则表达式的值也为NULL</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">select</span> ename NAME, <span class="number">12</span><span class="operator">*</span>sal<span class="operator">+</span>comm </span><br><span class="line">  <span class="number">2</span>  <span class="keyword">from</span>   emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>  ename<span class="operator">=</span><span class="string">&#x27;KING&#x27;</span>;</span><br><span class="line">  </span><br><span class="line">  NAME       <span class="number">12</span><span class="operator">*</span>SAL<span class="operator">+</span>COMM </span><br><span class="line"><span class="comment">---------- -----------</span></span><br><span class="line">KING                   </span><br></pre></td></tr></table></figure>

<hr>
<h5 id="列的别名"><a href="#列的别名" class="headerlink" title="列的别名"></a>列的别名</h5></li>
<li><p>如果别名中包含空格或特定的字符或需要区分大小写时，需要使用<strong>双引号。</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> ename <span class="keyword">AS</span> name, sal salary</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>   emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> ename &quot;Name&quot;,</span><br><span class="line">  <span class="number">2</span>         sal<span class="operator">*</span><span class="number">12</span> &quot;Annual Salary&quot;</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">FROM</span>   emp;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="连接符（-）"><a href="#连接符（-）" class="headerlink" title="连接符（||）"></a>连接符（||）</h5></li>
<li><p><strong>将两个串结合在一起，两个串可以是列名或直接量</strong>   </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> ename	<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span><span class="string">&#x27;is a&#x27;</span><span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>job </span><br><span class="line">  <span class="number">2</span>	         	<span class="keyword">AS</span> &quot;Employee Details&quot;</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">FROM</span>   emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Employee Details</span><br><span class="line"><span class="comment">-------------------------</span></span><br><span class="line">KING <span class="keyword">is</span> a PRESIDENT</span><br><span class="line">BLAKE <span class="keyword">is</span> a MANAGER</span><br><span class="line">CLARK <span class="keyword">is</span> a MANAGER</span><br><span class="line">JONES <span class="keyword">is</span> a MANAGER</span><br><span class="line">MARTIN <span class="keyword">is</span> a SALESMAN</span><br><span class="line">...</span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="DISTINCT"><a href="#DISTINCT" class="headerlink" title="DISTINCT"></a>DISTINCT</h5></li>
<li><p>使用<strong>DISTINCT</strong>关键字<strong>消除</strong>所选择的<strong>重复行</strong>，只返回一行。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> deptno</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>   emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   DEPTNO</span><br><span class="line"><span class="comment">---------</span></span><br><span class="line">       <span class="number">10</span></span><br><span class="line">       <span class="number">20</span></span><br><span class="line">       <span class="number">30</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="条件（WHERE）-比较符"><a href="#条件（WHERE）-比较符" class="headerlink" title="条件（WHERE）:比较符"></a>条件（WHERE）:比较符</h5><p><img src="1-3.png"></p>
<p><img src="1-4.png"></p>
<h6 id="比较符，BETWEEN"><a href="#比较符，BETWEEN" class="headerlink" title="比较符，BETWEEN"></a>比较符，BETWEEN</h6><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>	ename, sal</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span> 	emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>	sal <span class="keyword">BETWEEN</span> <span class="number">1000</span> <span class="keyword">AND</span> <span class="number">1500</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="比较符，IN"><a href="#比较符，IN" class="headerlink" title="比较符，IN"></a>比较符，IN</h6><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>	empno, ename, sal, mgr</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span> 	emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>	mgr <span class="keyword">IN</span> (<span class="number">7902</span>, <span class="number">7566</span>, <span class="number">7788</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h6 id="比较符，LIKE"><a href="#比较符，LIKE" class="headerlink" title="比较符，LIKE"></a>比较符，LIKE</h6><ul>
<li><strong>Oracle</strong>支持两种匹配符号：「 % 」 和「 _ 」 ，符号「 % 」可匹配0个或 多个字符 ，符号「 _ 」可匹配任何单一字符 。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>	ename</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>	emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>	ename <span class="keyword">LIKE</span> <span class="string">&#x27;_A%&#x27;</span>;</span><br><span class="line">  </span><br><span class="line">  ENAME</span><br><span class="line"><span class="comment">---------- </span></span><br><span class="line">JAMES   </span><br><span class="line">WARD</span><br></pre></td></tr></table></figure>



<ul>
<li><p>使用ESCAPE 定义查找「 % 」 和「 _ 」字符 。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ENAME <span class="keyword">FROM</span> EMP <span class="keyword">WHERE</span> ENAME <span class="keyword">LIKE</span> <span class="string">&#x27;%A\_B%&#x27;</span> <span class="keyword">ESCAPE</span> <span class="string">&#x27;\&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="比较符，IS-NULL"><a href="#比较符，IS-NULL" class="headerlink" title="比较符，IS NULL"></a>比较符，IS NULL</h6><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>  ename, mgr</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>    emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>   mgr <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line">  </span><br><span class="line">  ENAME            MGR</span><br><span class="line"><span class="comment">---------- ---------</span></span><br><span class="line">KING</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="条件（WHERE）-逻辑操作符"><a href="#条件（WHERE）-逻辑操作符" class="headerlink" title="条件（WHERE）:逻辑操作符"></a>条件（WHERE）:逻辑操作符</h5><p>  <img src="1-5.png"></p>
<h6 id="逻辑操作符，AND"><a href="#逻辑操作符，AND" class="headerlink" title="逻辑操作符，AND"></a>逻辑操作符，AND</h6><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> empno, ename, job, sal</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>   emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>  sal<span class="operator">&gt;=</span><span class="number">1100</span></span><br><span class="line">  <span class="number">4</span>  <span class="keyword">AND</span>    job<span class="operator">=</span><span class="string">&#x27;CLERK&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    EMPNO ENAME      JOB             SAL</span><br><span class="line"><span class="comment">--------- ---------- --------- ---------</span></span><br><span class="line">     <span class="number">7876</span> ADAMS      CLERK          <span class="number">1100</span></span><br><span class="line">     <span class="number">7934</span> MILLER     CLERK          <span class="number">1300</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="操作符，OR"><a href="#操作符，OR" class="headerlink" title="操作符，OR"></a>操作符，OR</h6><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> empno, ename, job, sal</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>   emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>  sal<span class="operator">&gt;=</span><span class="number">1100</span></span><br><span class="line">  <span class="number">4</span>  <span class="keyword">OR</span>     job<span class="operator">=</span><span class="string">&#x27;CLERK&#x27;</span>;</span><br><span class="line"></span><br><span class="line">EMPNO ENAME      JOB             SAL</span><br><span class="line"><span class="comment">--------- ---------- --------- ---------</span></span><br><span class="line">     </span><br><span class="line">     <span class="number">7839</span> KING       PRESIDENT      <span class="number">5000</span></span><br><span class="line">     <span class="number">7698</span> BLAKE      MANAGER        <span class="number">2850</span></span><br><span class="line">     <span class="number">7782</span> CLARK      MANAGER        <span class="number">2450</span></span><br><span class="line">     <span class="number">7566</span> JONES      MANAGER        <span class="number">2975</span></span><br><span class="line">     <span class="number">7654</span> MARTIN     SALESMAN       <span class="number">1250</span></span><br><span class="line">...</span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> selected.</span><br></pre></td></tr></table></figure>



<h6 id="逻辑操作符，NOT"><a href="#逻辑操作符，NOT" class="headerlink" title="逻辑操作符，NOT"></a>逻辑操作符，NOT</h6><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> ename, job</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>   emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>  job <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="string">&#x27;CLERK&#x27;</span>,<span class="string">&#x27;MANAGER&#x27;</span>,<span class="string">&#x27;ANALYST&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">ENAME      JOB</span><br><span class="line"><span class="comment">---------- ---------</span></span><br><span class="line">KING       PRESIDENT</span><br><span class="line">MARTIN     SALESMAN</span><br><span class="line">ALLEN      SALESMAN</span><br><span class="line">TURNER     SALESMAN</span><br><span class="line">WARD       SALESMAN</span><br></pre></td></tr></table></figure>

<h5 id="条件（WHERE）-优先规则"><a href="#条件（WHERE）-优先规则" class="headerlink" title="条件（WHERE）:优先规则"></a>条件（WHERE）:优先规则</h5><p><img src="1-6.png"></p>
<h5 id="排序（ORDER-BY子句）"><a href="#排序（ORDER-BY子句）" class="headerlink" title="排序（ORDER BY子句）"></a>排序（ORDER BY子句）</h5><ul>
<li><strong>排序（</strong>ORDER BY子句）：使得SQL在显示查询结果时将各返回行按顺序排列，返回行的排列顺序由ORDER BY 子句指定的表达式的值确定<ol>
<li>ASC: 从小到大排序（default）</li>
<li>DESC： 从大到小排序</li>
<li>ORDER BY子句在SELECT语句的最后</li>
</ol>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> ename,job,deptno,hiredate </span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>    	 emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">ORDER</span> <span class="keyword">BY</span> hiredate <span class="keyword">DESC</span>;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  ENAME      JOB          DEPTNO HIREDATE</span><br><span class="line"><span class="comment">---------- --------- --------- ---------</span></span><br><span class="line">ADAMS      CLERK            <span class="number">20</span> <span class="number">12</span><span class="operator">-</span>JAN<span class="number">-83</span></span><br><span class="line">SCOTT      ANALYST          <span class="number">20</span> <span class="number">09</span><span class="operator">-</span><span class="type">DEC</span><span class="number">-82</span></span><br><span class="line">MILLER     CLERK            <span class="number">10</span> <span class="number">23</span><span class="operator">-</span>JAN<span class="number">-82</span></span><br><span class="line">...</span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> selected.</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>Oracle</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>Oracle复习5</title>
    <url>/2021/11/11/Oracle%E5%A4%8D%E4%B9%A05/</url>
    <content><![CDATA[<h3 id="单行函数"><a href="#单行函数" class="headerlink" title="单行函数"></a>单行函数</h3><p>单行函数分类</p>
<p><img src="1-1.png"></p>
<h4 id="字符函数"><a href="#字符函数" class="headerlink" title="字符函数"></a>字符函数</h4><p>字符函数的分类</p>
<p><img src="1-2.png"></p>
<p>常用函数列表</p>
<p><img src="1-3.png"></p>
<h5 id="用例"><a href="#用例" class="headerlink" title="用例"></a>用例</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> ename, CONCAT (ename, job), LENGTH(ename),</span><br><span class="line">   <span class="number">2</span> 	INSTR(ename, <span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">   <span class="number">3</span> <span class="keyword">FROM</span>   emp</span><br><span class="line">   <span class="number">4</span> <span class="keyword">WHERE</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   ENAME      CONCAT(ENAME,JOB)   LENGTH(ENAME) INSTR(ENAME,<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line"><span class="comment">---------- ------------------- ------------- ----------------</span></span><br><span class="line">MARTIN     MARTINSALESMAN                  <span class="number">6</span>                <span class="number">2</span></span><br><span class="line">ALLEN      ALLENSALESMAN                   <span class="number">5</span>                <span class="number">1</span></span><br><span class="line">TURNER     TURNERSALESMAN                  <span class="number">6</span>                <span class="number">0</span></span><br><span class="line">WARD       WARDSALESMAN                    <span class="number">4</span>                <span class="number">2</span></span><br></pre></td></tr></table></figure>

<h4 id="数值函数"><a href="#数值函数" class="headerlink" title="数值函数"></a>数值函数</h4><p><img src="1-4.png"></p>
<h5 id="ROUND函数"><a href="#ROUND函数" class="headerlink" title="ROUND函数"></a>ROUND函数</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> ROUND(<span class="number">45.923</span>,<span class="number">2</span>), ROUND(<span class="number">45.923</span>,<span class="number">0</span>),</span><br><span class="line">  <span class="number">2</span>  		ROUND(<span class="number">45.923</span>,<span class="number">-1</span>)</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">FROM</span>   DUAL;</span><br><span class="line">  </span><br><span class="line">  ROUND(<span class="number">45.923</span>,<span class="number">2</span>) ROUND(<span class="number">45.923</span>,<span class="number">0</span>) ROUND(<span class="number">45.923</span>,<span class="number">-1</span>)</span><br><span class="line"><span class="comment">--------------- -------------- -----------------</span></span><br><span class="line">          <span class="number">45.92</span>             <span class="number">46</span>                <span class="number">50</span></span><br></pre></td></tr></table></figure>

<hr>
<h5 id="TRUNC函数"><a href="#TRUNC函数" class="headerlink" title="TRUNC函数"></a>TRUNC函数</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> 	TRUNC(<span class="number">45.923</span>,<span class="number">2</span>), TRUNC(<span class="number">45.923</span>),</span><br><span class="line">  <span class="number">2</span>  		TRUNC(<span class="number">45.923</span>,<span class="number">-1</span>)</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">FROM</span>   DUAL;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  TRUNC(<span class="number">45.923</span>,<span class="number">2</span>) TRUNC(<span class="number">45.923</span>) TRUNC(<span class="number">45.923</span>,<span class="number">-1</span>)</span><br><span class="line"><span class="comment">--------------- ------------- ---------------</span></span><br><span class="line">          <span class="number">45.92</span>            <span class="number">45</span>              <span class="number">40</span></span><br></pre></td></tr></table></figure>

<h5 id="MOD函数"><a href="#MOD函数" class="headerlink" title="MOD函数"></a>MOD函数</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>	ename, sal, comm, <span class="built_in">MOD</span>(sal, comm)</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>	emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>	job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span>;</span><br><span class="line"></span><br><span class="line">ENAME            SAL      COMM <span class="built_in">MOD</span>(SAL,COMM)</span><br><span class="line"><span class="comment">---------- --------- --------- -------------</span></span><br><span class="line">MARTIN          <span class="number">1250</span>      <span class="number">1400</span>          <span class="number">1250</span></span><br><span class="line">ALLEN           <span class="number">1600</span>       <span class="number">300</span>           <span class="number">100</span></span><br><span class="line">TURNER          <span class="number">1500</span>         <span class="number">0</span>          <span class="number">1500</span></span><br><span class="line">WARD            <span class="number">1250</span>       <span class="number">500</span>           <span class="number">250</span></span><br></pre></td></tr></table></figure>

<h4 id="日期函数"><a href="#日期函数" class="headerlink" title="日期函数"></a>日期函数</h4><h5 id="日期类型"><a href="#日期类型" class="headerlink" title="日期类型"></a>日期类型</h5><ul>
<li>Oracle是用数字来存储日期信息，数字的整数部分代表与Julian Calendar（罗马儒略历，公历）相距的天数 （由公元前4712年1月1日开始），而小数部分代表时、分和秒。</li>
<li>Oracle默认日期格式：<strong>DD-MON-YY</strong></li>
<li>SYSDATE函数返回系统当前的日期和时间。</li>
<li>DUAL是Oracle内置的虚拟表，只有一行一列。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  SYSDATE  <span class="keyword">FROM</span>  DUAL;</span><br><span class="line"><span class="keyword">SELECT</span>  TO_CHAR(SYSDATE,<span class="string">&#x27;YYYY-MM-DD HH24:MI:SS&#x27;</span>) <span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>

<h5 id="日期运算"><a href="#日期运算" class="headerlink" title="日期运算"></a>日期运算</h5><ul>
<li><strong>不允许日期加日期</strong></li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> ename, (SYSDATE<span class="operator">-</span>hiredate)<span class="operator">/</span><span class="number">7</span> WEEKS</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>   emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>  deptno <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ENAME          WEEKS</span><br><span class="line"><span class="comment">---------- ---------</span></span><br><span class="line">KING       <span class="number">830.93709</span></span><br><span class="line">CLARK      <span class="number">853.93709</span></span><br><span class="line">MILLER     <span class="number">821.36566</span></span><br></pre></td></tr></table></figure>



<p><img src="1-5.png"></p>
<h5 id="应用举例"><a href="#应用举例" class="headerlink" title="应用举例"></a>应用举例</h5><p><img src="1-6.png"></p>
<h4 id="转换函数"><a href="#转换函数" class="headerlink" title="转换函数"></a>转换函数</h4><h5 id="隐式转换"><a href="#隐式转换" class="headerlink" title="隐式转换"></a>隐式转换</h5><p><img src="1-7.png"></p>
<h5 id="显示转换"><a href="#显示转换" class="headerlink" title="显示转换"></a>显示转换</h5><p><img src="1-8.png"></p>
<h5 id="TO-CHAR（日期）函数"><a href="#TO-CHAR（日期）函数" class="headerlink" title="TO_CHAR（日期）函数"></a>TO_CHAR（日期）函数</h5><p><img src="1-9.png"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>	ename, 	</span><br><span class="line">  <span class="number">2</span>    	TO_CHAR(hiredate, ‘DD <span class="keyword">Month</span> YYYY<span class="string">&#x27;) HIREDATE</span></span><br><span class="line"><span class="string">  3  FROM  	emp;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">          ENAME      HIREDATE</span></span><br><span class="line"><span class="string">---------- -----------------</span></span><br><span class="line"><span class="string">KING       17 November 1981</span></span><br><span class="line"><span class="string">BLAKE      1 May 1981</span></span><br><span class="line"><span class="string">CLARK      9 June 1981</span></span><br><span class="line"><span class="string">JONES      2 April 1981</span></span><br><span class="line"><span class="string">MARTIN     28 September 1981</span></span><br><span class="line"><span class="string">ALLEN      20 February 1981</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">14 rows selected.</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<h5 id="TO-CHAR（数值）函数"><a href="#TO-CHAR（数值）函数" class="headerlink" title="TO_CHAR（数值）函数"></a>TO_CHAR（数值）函数</h5><p><img src="1-10.png"></p>
<p><img src="1-11.png"></p>
<h5 id="空值置换函数"><a href="#空值置换函数" class="headerlink" title="空值置换函数"></a>空值置换函数</h5><ol>
<li>NVL (expr1, expr2)</li>
</ol>
<ul>
<li>空值置换函数<strong>NVL</strong> ：如果表达式expr1为NULL ，就返回expr2的值.否则，函数就返回表达式expr1的值</li>
</ul>
<ol start="2">
<li>NVL2 (expr1, expr2, expr3)</li>
</ol>
<ul>
<li>空值置换函数<strong>NVL2</strong> ：<strong>如果表达式expr1为NULL</strong> ，就返回expr3的值.否则，函数就返回表达式expr2的值。</li>
</ul>
<p><img src="1-12.png"></p>
<h4 id="条件表达式"><a href="#条件表达式" class="headerlink" title="条件表达式"></a>条件表达式</h4><ul>
<li><strong>条件表达式</strong>：在SQL语句内，提供的IF-THEN-ELSE逻辑表达式。有两种方法:<ul>
<li>CASE表达式</li>
<li>DECODE函数</li>
</ul>
</li>
</ul>
<p><img src="1-13.png"></p>
<p><img src="1-14.png"></p>
<p><img src="1-15.png"></p>
]]></content>
      <categories>
        <category>Oracle</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>Oracle复习6</title>
    <url>/2021/11/11/Oracle%E5%A4%8D%E4%B9%A06/</url>
    <content><![CDATA[<h3 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h3><h4 id="相等连接"><a href="#相等连接" class="headerlink" title="相等连接"></a>相等连接</h4><p><img src="1-1.png"></p>
<h4 id="不相等连接"><a href="#不相等连接" class="headerlink" title="不相等连接"></a>不相等连接</h4><p><img src="1-2.png"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> 	<span class="keyword">SELECT</span> 	e.ename, e.sal, s.grade</span><br><span class="line">   <span class="number">2</span>	<span class="keyword">FROM</span>	emp e, salgrade s</span><br><span class="line">   <span class="number">3</span>	<span class="keyword">WHERE</span> 	e.sal</span><br><span class="line">   <span class="number">4</span>	<span class="keyword">BETWEEN</span> 	s.losal <span class="keyword">AND</span> s.hisal;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ENAME            SAL     GRADE</span><br><span class="line"><span class="comment">---------- --------- ---------</span></span><br><span class="line">JAMES            <span class="number">950</span>         <span class="number">1</span></span><br><span class="line">SMITH            <span class="number">800</span>         <span class="number">1</span></span><br><span class="line">ADAMS           <span class="number">1100</span>         <span class="number">1</span></span><br><span class="line">...</span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> selected.</span><br></pre></td></tr></table></figure>

<h4 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h4><ul>
<li><strong>外连接</strong>(Outer Joins) —是对简单联接的扩充，它返回简单联接所返回的全部行，而且还返回一表中不与另一表的行相匹配的行</li>
</ul>
<p><img src="1-3.png"></p>
<ul>
<li>外连接操作符时(+)加号（表示在该表中加入一个空行来与没有直接匹配行的数据进行匹配）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>	table.column, table.column</span><br><span class="line"><span class="keyword">FROM</span>	table1, table2</span><br><span class="line"><span class="keyword">WHERE</span>	table1.column(<span class="operator">+</span>) <span class="operator">=</span> table2.column;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span>	table.column, table.column</span><br><span class="line"><span class="keyword">FROM</span>	table1, table2</span><br><span class="line"><span class="keyword">WHERE</span>	table1.column <span class="operator">=</span> table2.column(<span class="operator">+</span>);</span><br></pre></td></tr></table></figure>

<p><strong>查询每个部门包括的雇员，如某部门没雇员，也要显示其情况。要求显示部门名称，雇员名字</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>	e.ename, d.deptno, d.dname</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>	emp e, dept d</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>	e.deptno(<span class="operator">+</span>) <span class="operator">=</span> d.deptno</span><br><span class="line">  <span class="number">4</span>  <span class="keyword">ORDER</span> <span class="keyword">BY</span>	e.deptno;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ENAME         DEPTNO DNAME</span><br><span class="line"><span class="comment">---------- --------- -------------</span></span><br><span class="line">KING              <span class="number">10</span> ACCOUNTING</span><br><span class="line">CLARK             <span class="number">10</span> ACCOUNTING</span><br><span class="line">...</span><br><span class="line">                  <span class="number">40</span> OPERATIONS</span><br><span class="line"><span class="number">15</span> <span class="keyword">rows</span> selected.</span><br></pre></td></tr></table></figure>

<h4 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h4><p><img src="1-4.png"></p>
<ul>
<li>查询每个有上级的员工的姓名，及其上级员工的姓名</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> worker.ename<span class="operator">||</span><span class="string">&#x27; works for &#x27;</span><span class="operator">||</span>manager.ename</span><br><span class="line">    <span class="keyword">FROM</span> 	emp worker, emp manager</span><br><span class="line">    <span class="keyword">WHERE</span> 	worker.mgr <span class="operator">=</span> manager.empno;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">WORKER.ENAME<span class="operator">||</span><span class="string">&#x27;WORKSFOR&#x27;</span><span class="operator">||</span>MANAG</span><br><span class="line"><span class="comment">-------------------------------</span></span><br><span class="line">BLAKE works <span class="keyword">for</span> KING</span><br><span class="line">CLARK works <span class="keyword">for</span> KING</span><br><span class="line">JONES works <span class="keyword">for</span> KING</span><br><span class="line">MARTIN works <span class="keyword">for</span> BLAKE</span><br><span class="line">...</span><br><span class="line"><span class="number">13</span> <span class="keyword">rows</span> selected.</span><br></pre></td></tr></table></figure>

<h4 id="递归查询-树查询"><a href="#递归查询-树查询" class="headerlink" title="递归查询(树查询)"></a>递归查询(树查询)</h4><ul>
<li><p>语法：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [LEVEL], <span class="keyword">column</span>, expr...</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">table</span></span><br><span class="line">[<span class="keyword">WHERE</span> <span class="keyword">condition</span>(s)]</span><br><span class="line">[<span class="keyword">START</span> <span class="keyword">WITH</span> <span class="keyword">condition</span>(s)]</span><br><span class="line">[<span class="keyword">CONNECT</span> <span class="keyword">BY</span> PRIOR <span class="keyword">condition</span>(s)]</span><br></pre></td></tr></table></figure></li>
<li><p>根据员工的管辖关系，显示员工的上下级关系树</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> lpad(ename,length(ename)<span class="operator">+</span>(level<span class="number">-1</span>)<span class="operator">*</span><span class="number">3</span>,<span class="string">&#x27;-&#x27;</span>) employee,level</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">WITH</span> ename <span class="operator">=</span> <span class="string">&#x27;KING&#x27;</span></span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> PRIOR empno <span class="operator">=</span> mgr;</span><br></pre></td></tr></table></figure>

<p><img src="1-5.png"></p>
<p><font color="#dd0000">PRIOR位置决定查子树还是回溯</font><br/></p>
<ul>
<li>查询员工JONES的所有下属员工</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> empno,ename,level</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">WITH</span> ename <span class="operator">=</span> <span class="string">&#x27;JONES&#x27;</span></span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> PRIOR empno <span class="operator">=</span> mgr</span><br></pre></td></tr></table></figure>

<ul>
<li>查询员工JONES的所有上级员工</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> empno, ename,level</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">WITH</span> ename <span class="operator">=</span> <span class="string">&#x27;JONES&#x27;</span></span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> empno <span class="operator">=</span> PRIOR  mgr;</span><br></pre></td></tr></table></figure>

<h3 id="分组函数"><a href="#分组函数" class="headerlink" title="分组函数"></a>分组函数</h3><ul>
<li><p>分组函数(Group Functions)：对多行进行操作，并为每一组给出一个结果。</p>
</li>
<li><p>语法</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>	[<span class="keyword">column</span>,] group_function(<span class="keyword">column</span>), ...</span><br><span class="line"><span class="keyword">FROM</span>		<span class="keyword">table</span></span><br><span class="line">[<span class="keyword">WHERE</span>	<span class="keyword">condition</span>]</span><br><span class="line">[<span class="keyword">GROUP</span> <span class="keyword">BY</span>	<span class="keyword">column</span>]</span><br><span class="line">[<span class="keyword">ORDER</span> <span class="keyword">BY</span>	<span class="keyword">column</span>];</span><br></pre></td></tr></table></figure>

<p><img src="1-6.png"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(sal), <span class="built_in">MAX</span>(sal), <span class="built_in">MIN</span>(sal), <span class="built_in">SUM</span>(sal)	<span class="keyword">FROM</span>	emp</span><br><span class="line">	<span class="keyword">WHERE</span> job <span class="keyword">LIKE</span> <span class="string">&#x27;SALES%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(comm), <span class="built_in">MAX</span>(comm), <span class="built_in">MIN</span>(comm), <span class="built_in">SUM</span>(comm) <span class="keyword">FROM</span> emp;</span><br><span class="line">	<span class="comment">--WHERE job LIKE &#x27;SALES%&#x27;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- AVG, MAX, MIN, SUM在计算时会忽略NULL行</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(comm), <span class="built_in">MAX</span>(comm), <span class="built_in">MIN</span>(comm), <span class="built_in">SUM</span>(comm)	<span class="keyword">FROM</span>	emp </span><br><span class="line"> <span class="keyword">WHERE</span> job <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">&#x27;SALES%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- AVG, MAX, MIN, SUM在全为NULL时计算结果为NULL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(hiredate), <span class="built_in">MAX</span>(hiredate)  <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>COUNT(*)</strong> <strong>返回表中所有行</strong></li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>	<span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">  <span class="keyword">FROM</span>	emp</span><br><span class="line">  <span class="keyword">WHERE</span>	deptno <span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line">  </span><br><span class="line">   <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="comment">---------</span></span><br><span class="line">        <span class="number">6</span></span><br></pre></td></tr></table></figure>

<ul>
<li>COUNT(expr)返回表中指定列的非NULL行数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>	<span class="built_in">COUNT</span>(comm)</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>	emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>	deptno <span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">COUNT</span>(COMM)</span><br><span class="line"><span class="comment">-----------</span></span><br><span class="line">          <span class="number">4</span></span><br></pre></td></tr></table></figure>

<h3 id="数据分组"><a href="#数据分组" class="headerlink" title="数据分组"></a>数据分组</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用GROUP BY子句将表中的行划分成小组</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>   deptno, <span class="built_in">AVG</span>(sal)</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>     emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br><span class="line">  </span><br><span class="line">  DEPTNO  <span class="built_in">AVG</span>(SAL)</span><br><span class="line"><span class="comment">--------- ---------</span></span><br><span class="line">       <span class="number">10</span> <span class="number">2916.6667</span></span><br><span class="line">       <span class="number">20</span>      <span class="number">2175</span></span><br><span class="line">       <span class="number">30</span> <span class="number">1566.6667</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 多列分组</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>   deptno, job, <span class="built_in">sum</span>(sal)</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>     emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno, job;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">     DEPTNO JOB        <span class="built_in">SUM</span>(SAL)</span><br><span class="line"><span class="comment">--------- --------- ---------</span></span><br><span class="line">       <span class="number">10</span> CLERK          <span class="number">1300</span></span><br><span class="line">       <span class="number">10</span> MANAGER        <span class="number">2450</span></span><br><span class="line">       <span class="number">10</span> PRESIDENT      <span class="number">5000</span></span><br><span class="line">       <span class="number">20</span> ANALYST        <span class="number">6000</span></span><br><span class="line">       <span class="number">20</span> CLERK          <span class="number">1900</span></span><br><span class="line">...</span><br><span class="line"><span class="number">9</span> <span class="keyword">rows</span> selected.</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> (<span class="keyword">SELECT</span> DNAME <span class="keyword">FROM</span> DEPT <span class="keyword">WHERE</span> DEPTNO<span class="operator">=</span>EMP.DEPTNO),</span><br><span class="line"><span class="built_in">COUNT</span>(EMPNO) <span class="keyword">FROM</span> EMP</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> DEPTNO;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">SELECT</span> D.C,DEPT.<span class="operator">*</span> <span class="keyword">FROM</span></span><br><span class="line">(<span class="keyword">SELECT</span> DEPTNO,<span class="built_in">COUNT</span>(EMPNO) C <span class="keyword">FROM</span> EMP</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> DEPTNO) D,DEPT </span><br><span class="line"><span class="keyword">WHERE</span> D.DEPTNO(<span class="operator">+</span>)<span class="operator">=</span>DEPT.DEPTNO;</span><br></pre></td></tr></table></figure>

<h3 id="限制选择组-HAVING子句"><a href="#限制选择组-HAVING子句" class="headerlink" title="限制选择组(HAVING子句)"></a>限制选择组(HAVING子句)</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>   deptno, <span class="built_in">max</span>(sal)</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>     emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno</span><br><span class="line">  <span class="number">4</span>  <span class="keyword">HAVING</span>   <span class="built_in">max</span>(sal)<span class="operator">&gt;</span><span class="number">2900</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>非法使用分组函数</p>
<ul>
<li><p>非法使用分组函数，使用组函数必须使用GROUP BY 子句</p>
<ul>
<li><img src="1-7.png"></li>
</ul>
</li>
<li><p>在WHERE子句中不能直接使用组函数。</p>
</li>
<li><p>在HAVING子句中可以直接使用组函数</p>
<ul>
<li><img src="1-8.png"></li>
</ul>
</li>
</ul>
<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><ul>
<li>语法</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>	select_list</span><br><span class="line"><span class="keyword">FROM</span>	<span class="keyword">table</span></span><br><span class="line"><span class="keyword">WHERE</span>	expr operator</span><br><span class="line">		 	(<span class="keyword">SELECT</span>	select_list</span><br><span class="line">		       <span class="keyword">FROM</span>		<span class="keyword">table</span>);</span><br></pre></td></tr></table></figure>



<ul>
<li>子查询（内部查询）在主查询之前执行。</li>
<li>子查询的查询结果提供给主查询(外部查询)使用。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> ename</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>   emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">WHERE</span>  sal <span class="operator">&gt;</span> </span><br><span class="line">  <span class="number">4</span>		    (<span class="keyword">SELECT</span> sal</span><br><span class="line">  <span class="number">5</span>               <span class="keyword">FROM</span>   emp</span><br><span class="line">  <span class="number">6</span>               <span class="keyword">WHERE</span>  empno<span class="operator">=</span><span class="number">7566</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ENAME</span><br><span class="line"><span class="comment">----------</span></span><br><span class="line">KING</span><br><span class="line">FORD</span><br><span class="line">SCOTT</span><br></pre></td></tr></table></figure>

<h5 id="子查询使用原则"><a href="#子查询使用原则" class="headerlink" title="子查询使用原则"></a>子查询使用原则</h5><ol>
<li>子查询应该封装在括号内</li>
<li>子查询在比较条件的右边</li>
<li>子查询中一般不使用ORDER BY子句。</li>
<li>单行子查询使用单行操作符，多行子查询使用多行操作符</li>
</ol>
<h5 id="单行子查询"><a href="#单行子查询" class="headerlink" title="单行子查询"></a>单行子查询</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span>	deptno, <span class="built_in">MIN</span>(sal)</span><br><span class="line">  <span class="number">2</span>  <span class="keyword">FROM</span>	emp</span><br><span class="line">  <span class="number">3</span>  <span class="keyword">GROUP</span> <span class="keyword">BY</span>	deptno</span><br><span class="line">  <span class="number">4</span>  <span class="keyword">HAVING</span>	<span class="built_in">MIN</span>(sal) <span class="operator">&gt;</span></span><br><span class="line">  <span class="number">5</span>		(<span class="keyword">SELECT</span>	<span class="built_in">MIN</span>(sal)</span><br><span class="line">  <span class="number">6</span>		<span class="keyword">FROM</span>	emp</span><br><span class="line">  <span class="number">7</span>		<span class="keyword">WHERE</span>	deptno <span class="operator">=</span> <span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<h5 id="多行子查询"><a href="#多行子查询" class="headerlink" title="多行子查询"></a>多行子查询</h5><p><img src="1-9.png"></p>
<p><img src="1-10.png"></p>
<h5 id="多行子查询EXISTS应用举例："><a href="#多行子查询EXISTS应用举例：" class="headerlink" title="多行子查询EXISTS应用举例："></a>多行子查询EXISTS应用举例：</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  e.empno, e.ename</span><br><span class="line"><span class="keyword">FROM</span>    emp e</span><br><span class="line"><span class="keyword">WHERE</span>   <span class="keyword">EXISTS</span> (<span class="keyword">SELECT</span> ‘X’</span><br><span class="line">		<span class="keyword">FROM</span>  dept d</span><br><span class="line">		<span class="keyword">WHERE</span> e.deptno<span class="operator">=</span>d.deptno</span><br><span class="line">		<span class="keyword">and</span> d.loc<span class="operator">=</span> <span class="string">&#x27;NEW YORK&#x27;</span>);</span><br><span class="line">	</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">SELECT</span>  e.empno, e.ename</span><br><span class="line"><span class="keyword">FROM</span>    emp e</span><br><span class="line"><span class="keyword">WHERE</span>   e.deptno <span class="keyword">in</span> (<span class="keyword">SELECT</span> d.deptno</span><br><span class="line">		<span class="keyword">FROM</span>  dept d</span><br><span class="line">		<span class="keyword">WHERE</span>  d.loc<span class="operator">=</span> <span class="string">&#x27;NEW YORK&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="多行子查询IN应用举例："><a href="#多行子查询IN应用举例：" class="headerlink" title="多行子查询IN应用举例："></a>多行子查询IN应用举例：</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  e.empno, e.ename</span><br><span class="line"><span class="keyword">FROM</span>    emp e</span><br><span class="line"><span class="keyword">WHERE</span>   e.deptno <span class="keyword">in</span> (<span class="keyword">SELECT</span> d.deptno</span><br><span class="line">		<span class="keyword">FROM</span>  dept d</span><br><span class="line">		<span class="keyword">WHERE</span>  d.loc<span class="operator">=</span> <span class="string">&#x27;NEW YORK&#x27;</span> </span><br><span class="line">				<span class="keyword">or</span> d.loc<span class="operator">=</span> <span class="string">&#x27;CHICAGO&#x27;</span>);</span><br><span class="line">				</span><br><span class="line">				</span><br><span class="line"><span class="keyword">SELECT</span>  e.empno, e.ename,d.loc</span><br><span class="line"><span class="keyword">FROM</span>    emp e,</span><br><span class="line">   (<span class="keyword">SELECT</span> deptno,loc <span class="keyword">FROM</span>  dept </span><br><span class="line">    <span class="keyword">WHERE</span>  loc<span class="operator">=</span> ‘<span class="keyword">NEW</span> YORK’ <span class="keyword">or</span> loc<span class="operator">=</span> <span class="string">&#x27;CHICAGO&#x27;</span>) d</span><br><span class="line"><span class="keyword">WHERE</span>   e.deptno <span class="operator">=</span>d.deptno;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Oracle</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>Oracle复习7</title>
    <url>/2021/11/11/Oracle%E5%A4%8D%E4%B9%A07/</url>
    <content><![CDATA[<h3 id="匿名块"><a href="#匿名块" class="headerlink" title="匿名块"></a>匿名块</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> (可选)</span><br><span class="line">    定义在PL<span class="operator">/</span><span class="keyword">SQL</span>块中要使用的对象</span><br><span class="line"><span class="keyword">BEGIN</span> (必须)</span><br><span class="line">    执行语句</span><br><span class="line">EXCEPTION (可选)</span><br><span class="line">    错误处理语句</span><br><span class="line"><span class="keyword">END</span>; (必须)</span><br></pre></td></tr></table></figure>

<ul>
<li>匿名块（以DECLARE或BEGIN开始）每次使用时都要进行编译。</li>
<li>匿名块不存储在数据库中，并且它不能从其它的PL/SQL块中进行调用。</li>
</ul>
<h3 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h3><ul>
<li>触发器类似于过程和函数，都拥有声明、执行和异常处理过程的带名PL/SQL块。与包类似，触发器必须存储在数据库中。</li>
<li>前面已经讲过，过程是显式地通过过程调用执行的，同时过程调用可以传递参数。与之相反，触发器是在事件发生时隐式地运行的，并且触发器不能接受参数。</li>
<li>触发事件可以是对数据库表的DML（INSERT、UPDATE、DELETE）操作或某种视图的操作。Oracle8i把触发器功能扩展到了可以激发系统事件，如数据库的启动和关闭，以及某种DDL操作。</li>
<li>触发器主要分为：DML触发器、替代触发器和系统触发器。本次课程主要讲述DML触发器。</li>
<li>触发器可用来补充声明的参照完整性，强制实施复杂的业务规则</li>
<li>触发器是一个独立的事务，被当作一个整体执行，在执行过程中如果发生错误，则整个事务会<strong>自动回滚</strong>。</li>
</ul>
<h4 id="DML触发器创建语法"><a href="#DML触发器创建语法" class="headerlink" title="DML触发器创建语法"></a>DML触发器创建语法</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- trigger_name是触发器名，triggering_event指定了何时激发触发器， table_reference是定义触发器的表， trigger_body是触发器</span></span><br><span class="line"><span class="comment">-- 的主要处理代码。WHEN子句的trigger_condition如果被使用的话，将首先进行求值。触发器的主体仅当此条件求值为TRUE时才被执行。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE] <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">   &#123;BEFORE <span class="operator">|</span> AFTER&#125; triggering_event <span class="keyword">ON</span> table_reference</span><br><span class="line">   [<span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> [<span class="keyword">WHEN</span> trigger_condition]]</span><br><span class="line">trigger_body;</span><br></pre></td></tr></table></figure>

<h4 id="触发器的激发顺序"><a href="#触发器的激发顺序" class="headerlink" title="触发器的激发顺序"></a>触发器的激发顺序</h4><ol>
<li>执行BEFORE语句级触发器（如果有的话）</li>
<li>对于受语句影响的每一行<ul>
<li>执行BEFORE行级触发器（如果有的话）</li>
<li>执行DML语句（系统自动执行）</li>
<li>执行AFTER行级触发器（如果有的话）</li>
</ul>
</li>
<li>执行AFTER语句级触发器（如果有的话）</li>
</ol>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">TRIGGER</span> tri_emp_stmBefore</span><br><span class="line">BEFORE <span class="keyword">INSERT</span>  <span class="keyword">ON</span> EMP</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;Before Statement trigger&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">TRIGGER</span> tri_emp_stmAfter</span><br><span class="line">after <span class="keyword">INSERT</span>  <span class="keyword">ON</span> EMP</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;After Statement trigger&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">TRIGGER</span> tri_emp_rowBefore</span><br><span class="line">before <span class="keyword">INSERT</span>  <span class="keyword">ON</span> EMP</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;Beore row trigger&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">TRIGGER</span> tri_emp_rowAfter</span><br><span class="line">after <span class="keyword">INSERT</span>  <span class="keyword">ON</span> EMP</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;After row trigger&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="语句级触发器例子"><a href="#语句级触发器例子" class="headerlink" title="语句级触发器例子"></a>语句级触发器例子</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">TRIGGER</span> secure_emp</span><br><span class="line">   BEFORE <span class="keyword">INSERT</span> <span class="keyword">ON</span> emp</span><br><span class="line">   <span class="keyword">BEGIN</span></span><br><span class="line">     IF (TO_CHAR(SYSDATE, <span class="string">&#x27;DY&#x27;</span>) <span class="keyword">IN</span> (<span class="string">&#x27;星期六&#x27;</span>, <span class="string">&#x27;星期天&#x27;</span>)) </span><br><span class="line">           <span class="keyword">OR</span> (TO_CHAR(SYSDATE, <span class="string">&#x27;HH24:MI&#x27;</span>) <span class="keyword">NOT</span> <span class="keyword">BETWEEN</span> <span class="string">&#x27;08:00&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;18:00&#x27;</span>)</span><br><span class="line">     <span class="keyword">THEN</span> </span><br><span class="line">         RAISE_APPLICATION_ERROR</span><br><span class="line">			 (<span class="number">-20500</span>, <span class="string">&#x27;You may insert into EMP table only during business hours.&#x27;</span>);</span><br><span class="line">      <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp (empno, ename,hiredate,job, sal, deptno)</span><br><span class="line">               <span class="keyword">VALUES</span> (<span class="number">300</span>,<span class="string">&#x27;Smith Rob&#x27;</span>,SYSDATE,<span class="string">&#x27;IT_PROG&#x27;</span>, <span class="number">4500</span>, <span class="number">30</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">TRIGGER</span> secure_emp</span><br><span class="line">BEFORE <span class="keyword">INSERT</span> <span class="keyword">OR</span> UPDATE <span class="keyword">OR</span> <span class="keyword">DELETE</span>  <span class="keyword">ON</span> EMP</span><br><span class="line">  <span class="keyword">BEGIN</span></span><br><span class="line">    IF (TO_CHAR(SYSDATE, <span class="string">&#x27;DY&#x27;</span>) <span class="keyword">IN</span> (<span class="string">&#x27;星期六&#x27;</span>, <span class="string">&#x27;星期天&#x27;</span>)) </span><br><span class="line">           <span class="keyword">OR</span> (TO_CHAR(SYSDATE, <span class="string">&#x27;HH24&#x27;</span>) <span class="keyword">NOT</span> <span class="keyword">BETWEEN</span> <span class="string">&#x27;08&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;18&#x27;</span>)</span><br><span class="line">    <span class="keyword">THEN</span> </span><br><span class="line">      IF DELETING <span class="keyword">THEN</span></span><br><span class="line">          RAISE_APPLICATION_ERROR (<span class="number">-20502</span>, <span class="string">&#x27;You may delete from  EMP table only during business hours.&#x27;</span>);</span><br><span class="line">       ELSIF INSERTING <span class="keyword">THEN</span></span><br><span class="line">         RAISE_APPLICATION_ERROR (<span class="number">-20500</span>,<span class="string">&#x27;You may insert into EMP table only during business hours.&#x27;</span>);</span><br><span class="line">       ELSIF UPDATING (<span class="string">&#x27;SAL&#x27;</span>) <span class="keyword">THEN</span></span><br><span class="line">         RAISE_APPLICATION_ERROR (<span class="number">-20503</span>,<span class="string">&#x27;You may update SAL only during business hours.&#x27;</span>);</span><br><span class="line">       <span class="keyword">ELSE</span></span><br><span class="line">         RAISE_APPLICATION_ERROR (<span class="number">-20504</span>,<span class="string">&#x27;You may update EMP table only during normal hours.&#x27;</span>);</span><br><span class="line">       <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h4 id="行级触发器例子"><a href="#行级触发器例子" class="headerlink" title="行级触发器例子"></a>行级触发器例子</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">TRIGGER</span> restrict_salary</span><br><span class="line">  BEFORE <span class="keyword">INSERT</span> <span class="keyword">OR</span> UPDATE <span class="keyword">ON</span> emp</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">      IF <span class="keyword">NOT</span> (:NEW.job <span class="keyword">IN</span> (<span class="string">&#x27;PRESIDENT&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>, <span class="string">&#x27;ANALYST&#x27;</span>)) <span class="keyword">AND</span> :NEW.sal <span class="operator">&gt;</span> <span class="number">2500</span></span><br><span class="line">      <span class="keyword">THEN</span></span><br><span class="line">        RAISE_APPLICATION_ERROR (<span class="number">-20202</span>, <span class="string">&#x27;Employee cannot earn this amount&#x27;</span>);</span><br><span class="line">      <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> UPDATE emp</span><br><span class="line">              <span class="keyword">SET</span> sal <span class="number">3000</span></span><br><span class="line">              <span class="keyword">WHERE</span> ename <span class="operator">=</span> <span class="string">&#x27;SMITH&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="行级触发器——-old和-new"><a href="#行级触发器——-old和-new" class="headerlink" title="行级触发器——:old和:new"></a>行级触发器——:old和:new</h4><p><img src="1-11.png"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">TRIGGER</span> audit_emp_values</span><br><span class="line">   AFTER <span class="keyword">DELETE</span> <span class="keyword">OR</span> <span class="keyword">INSERT</span> <span class="keyword">OR</span> UPDATE <span class="keyword">ON</span> emp</span><br><span class="line">   <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">   <span class="keyword">BEGIN</span></span><br><span class="line">      <span class="keyword">INSERT</span> <span class="keyword">INTO</span> audit_emp_table (user_name, <span class="type">timestamp</span>,empno,</span><br><span class="line">          old_ename, new_ename, old_job,new_job, old_sal, new_sal)</span><br><span class="line">          <span class="keyword">VALUES</span> (<span class="keyword">USER</span>, SYSDATE, :OLD.empno,:OLD.ename, :NEW.ename,</span><br><span class="line">              :OLD.job,:NEW.job, :OLD.sal, :NEW.sal );</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line">   t_oplog(<span class="keyword">user</span>,optime,opcontent)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="行级触发器——限制条件"><a href="#行级触发器——限制条件" class="headerlink" title="行级触发器——限制条件"></a>行级触发器——限制条件</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">TRIGGER</span> derive_commission_pct</span><br><span class="line">    BEFORE <span class="keyword">INSERT</span> <span class="keyword">OR</span> UPDATE <span class="keyword">OF</span> sal <span class="keyword">ON</span> emp</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">WHEN</span> (NEW.job <span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span>)</span><br><span class="line"> <span class="keyword">BEGIN</span></span><br><span class="line">    IF INSERTING  <span class="keyword">THEN</span> :NEW.comm :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    ELSIF :OLD.comm <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span> :NEW.comm :<span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">ELSE</span>  :NEW.comm :<span class="operator">=</span> :NEW.sal<span class="operator">*</span><span class="number">0.10</span>;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"> <span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h4 id="行级触发器应用"><a href="#行级触发器应用" class="headerlink" title="行级触发器应用"></a>行级触发器应用</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 练习:创建序列和触发器后,给出执行下面两个insert语句后的数据记录</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> SEQUENCE SEQ_EMPNO </span><br><span class="line"><span class="keyword">START</span> <span class="keyword">WITH</span> <span class="number">9000</span> </span><br><span class="line">MAXVALUE <span class="number">9999</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">---------</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">TRIGGER</span> tri_insert_emp</span><br><span class="line">  BEFORE <span class="keyword">INSERT</span>  <span class="keyword">ON</span> emp</span><br><span class="line">  <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  if :new.deptno <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span></span><br><span class="line">    :new.deptno:<span class="operator">=</span><span class="number">10</span>;</span><br><span class="line">  ELSIF :new.deptno<span class="operator">=</span><span class="number">30</span> <span class="keyword">then</span></span><br><span class="line">    :new.job:<span class="operator">=</span><span class="string">&#x27;SALSEMAN&#x27;</span>;</span><br><span class="line">  <span class="keyword">end</span> if;</span><br><span class="line">  <span class="keyword">SELECT</span> seq_empno.NEXTVAL</span><br><span class="line">      <span class="keyword">INTO</span> :new.empno</span><br><span class="line">      <span class="keyword">FROM</span> dual;</span><br><span class="line"><span class="keyword">END</span> tri_insert_emp;</span><br><span class="line"><span class="comment">--------</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (ename,sal) <span class="keyword">values</span> (‘LL<span class="string">&#x27;,2300);</span></span><br><span class="line"><span class="string">insert into emp (empno,ename,sal) values (9100,‘HH&#x27;</span>,<span class="number">2500</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="管理触发器"><a href="#管理触发器" class="headerlink" title="管理触发器"></a>管理触发器</h4><ul>
<li><p>禁用或启用一个触发器</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TRIGGER</span> trigger_name DISABLE <span class="operator">|</span> ENABLE</span><br></pre></td></tr></table></figure></li>
<li><p>禁用或启用一张表的多有触发器</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name DISABLE <span class="operator">|</span> ENABLE <span class="keyword">ALL</span> TRIGGERS</span><br></pre></td></tr></table></figure></li>
<li><p>重新编译一个触发器</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TRIGGER</span> trigger_name COMPILE</span><br></pre></td></tr></table></figure></li>
<li><p>删除触发器</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> trigger_name</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="子程序"><a href="#子程序" class="headerlink" title="子程序"></a>子程序</h3><ul>
<li>子程序是带名的PL/SQL块，能够接受参数和被环境调用。在PL/SQL中两类子程序：过程和函数</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">&lt;</span>header<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">IS</span> <span class="operator">|</span> <span class="keyword">AS</span></span><br><span class="line">    声明部分</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    执行部分</span><br><span class="line">EXCEPTION (可选)</span><br><span class="line">    异常处理部分</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>子程序说明（<em>header）决定</em>:<ul>
<li>PL/SQL子程序的类型是过程还是函数。</li>
<li>子程序的名称</li>
<li>参数列表</li>
<li>当子程序是函数时必须要有返回值(使用RETURN子句)</li>
<li>关键字IS或AS是必须的。</li>
</ul>
</li>
<li>子程序体:是一个拥有声明、执行和异常处理部分的PL/SQL块。<ul>
<li>声明部分介于<strong>IS|AS</strong>和<strong>BEGIN</strong>之间。在匿名块中必须使用<strong>DECLARE</strong>关键字显示的指出声明部分，而在<strong>子程序中没有DECLARE关键字</strong>。</li>
<li>执行部分介于BEGIN和END关键字之间，这部分必须存在</li>
<li>异常处理部分介于EXCEPTION和END之间是可选的部分</li>
</ul>
</li>
</ul>
<h4 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h4><h5 id="创建过程"><a href="#创建过程" class="headerlink" title="创建过程"></a>创建过程</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE] <span class="keyword">PROCEDURE</span> procedure_name </span><br><span class="line">[(parameter1 [<span class="keyword">IN</span> <span class="operator">|</span> <span class="keyword">OUT</span> <span class="operator">|</span> <span class="keyword">IN</span> <span class="keyword">OUT</span>] data_type , parameter2 [<span class="keyword">IN</span> <span class="operator">|</span> <span class="keyword">OUT</span> <span class="operator">|</span> <span class="keyword">IN</span> <span class="keyword">OUT</span>] data­_type,…)]</span><br><span class="line"><span class="keyword">IS</span> <span class="operator">|</span><span class="keyword">AS</span></span><br><span class="line">   [declaration_section;]</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   executable_section;</span><br><span class="line">[EXCEPTION</span><br><span class="line">   exception_handlers;]</span><br><span class="line"><span class="keyword">END</span> [procedure_name];</span><br><span class="line"><span class="comment">-- 注意与匿名块有三点区别：</span></span><br><span class="line"><span class="comment">-- 1.无DECLARE关键字</span></span><br><span class="line"><span class="comment">-- 2.在END后面可以加过程名  作为定义结束的标志</span></span><br><span class="line"><span class="comment">-- 3.存储过程定义完成后需要调用才能执行过程内部的代码。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> display_time </span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   dbms_output.put_line(systimestamp);</span><br><span class="line"><span class="keyword">END</span> display_time;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用三种方式调用上面创建的存储过程</span></span><br><span class="line"><span class="comment">-- 方式一：使用sqlplus命令EXECUTE(简写EXEC) 调用</span></span><br><span class="line">	<span class="keyword">EXECUTE</span> display_time; </span><br><span class="line"><span class="comment">-- 方式二：使用sql命令CALL调用</span></span><br><span class="line">	<span class="keyword">CALL</span> display_time( );</span><br><span class="line"><span class="comment">-- 方式三：在PL/SQL块中调用</span></span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		display_time;</span><br><span class="line">	<span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 形式参数(Formal parameters):在过程中声明的参数就是形式参数。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> insert_emp </span><br><span class="line">(<span class="keyword">no</span>  emp.empno<span class="operator">%</span>TYPE,			name  emp.ename<span class="operator">%</span>TYPE,</span><br><span class="line">Job  emp.job<span class="operator">%</span>TYPE,				mgr  emp.mgr<span class="operator">%</span>TYPE,</span><br><span class="line">hiredate emp.hiredate<span class="operator">%</span>TYPE ,	salary emp.sal<span class="operator">%</span>TYPE ,</span><br><span class="line">comm emp.comm<span class="operator">%</span>TYPE ,		deptno emp.deptno<span class="operator">%</span>TYPE </span><br><span class="line">)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span>(<span class="keyword">no</span>,name,job,mgr,hiredate,salary,comm,deptno);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="comment">-- 实际参数(Actual parameters):在调用过程中作为参数传递给过程的变量或表达式就是实际参数。</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">v_no  emp.empno<span class="operator">%</span>TYPE:<span class="operator">=</span><span class="number">10000</span>,</span><br><span class="line">v_name  emp.ename<span class="operator">%</span>TYPE :<span class="operator">=</span>‘Jones’,</span><br><span class="line">v_job  emp.job<span class="operator">%</span>TYPE :<span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span>,</span><br><span class="line">v_mgr  emp.mgr<span class="operator">%</span>TYPE :<span class="operator">=</span><span class="number">7369</span>,</span><br><span class="line">v_hiredate emp.hiredate<span class="operator">%</span>TYPE :<span class="operator">=</span>SYSDATE,</span><br><span class="line">v_salary emp.sal<span class="operator">%</span>TYPE :<span class="operator">=</span> <span class="number">800</span>,</span><br><span class="line">v_comm emp.comm<span class="operator">%</span>TYPE :<span class="operator">=</span><span class="keyword">NULL</span>,</span><br><span class="line">v_deptno emp.deptno<span class="operator">%</span>TYPE :<span class="operator">=</span><span class="number">10</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"> insert_emp(v_no, v_name, v_job, v_mgr, v_hiredate, v_salary, v_comm, v_deptno );</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 对形式参数的约束：在过程声明中，限制CHAR和VARCHAR2参数的长度以及限制NUMBER参数的精度和/或刻度范围都是非法的。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> ParameterLength (</span><br><span class="line">  p_Parameter1 <span class="keyword">IN</span> <span class="keyword">OUT</span> VARCHAR2(<span class="number">10</span>), <span class="comment">-- 非法</span></span><br><span class="line">  p_Parameter2 <span class="keyword">IN</span> <span class="keyword">OUT</span> NUMBER(<span class="number">3</span>,<span class="number">2</span>)) <span class="keyword">AS</span> <span class="comment">-- 非法</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  p_Parameter1 :<span class="operator">=</span> <span class="string">&#x27;abcdefghijklm&#x27;</span>;</span><br><span class="line">  p_Parameter2 :<span class="operator">=</span> <span class="number">12.3</span>;</span><br><span class="line"><span class="keyword">END</span> ParameterLength;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"><span class="comment">-- 过程声明非法</span></span><br></pre></td></tr></table></figure>

<h4 id="参数的模式"><a href="#参数的模式" class="headerlink" title="参数的模式"></a>参数的模式</h4><ul>
<li>过程可以通过参数和调用环境进行数据传递</li>
<li>有三种传递模式—<strong>IN、OUT和IN OUT</strong>。如果没有为形式参数指定模式，则使用<strong>缺省模式IN。</strong></li>
</ul>
<p><img src="1-12.png"></p>
<h4 id="IN参数"><a href="#IN参数" class="headerlink" title="IN参数"></a>IN参数</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> raise_salary</span><br><span class="line">(p_id <span class="keyword">IN</span> emp.empno<span class="operator">%</span>TYPE)       <span class="keyword">IS</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">     UPDATE emp          <span class="keyword">SET</span> sal <span class="operator">=</span> sal <span class="operator">*</span> <span class="number">1.10</span>          <span class="keyword">WHERE</span> empno <span class="operator">=</span> p_id;</span><br><span class="line"><span class="keyword">END</span> raise_salary;</span><br><span class="line"><span class="comment">-- 执行</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_empno emp.empno<span class="operator">%</span>TYPE:<span class="operator">=</span><span class="operator">&amp;</span><span class="keyword">no</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  raise_salary(v_empno);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="OUT参数"><a href="#OUT参数" class="headerlink" title="OUT参数"></a>OUT参数</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> query_emp</span><br><span class="line">(p_id <span class="keyword">IN</span> emp.empno<span class="operator">%</span>TYPE, p_name <span class="keyword">OUT</span> emp.ename<span class="operator">%</span>TYPE,</span><br><span class="line"> p_salary <span class="keyword">OUT</span> emp.sal<span class="operator">%</span>TYPE,p_comm <span class="keyword">OUT</span> emp.comm<span class="operator">%</span>TYPE)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">SELECT</span> ename, sal, comm</span><br><span class="line">      <span class="keyword">INTO</span> p_name, p_salary, p_comm</span><br><span class="line">      <span class="keyword">FROM</span> emp  <span class="keyword">WHERE</span> empno <span class="operator">=</span> p_id;</span><br><span class="line"><span class="keyword">END</span> query_emp;</span><br><span class="line"><span class="comment">-- 执行</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_empno emp.empno<span class="operator">%</span>TYPE:<span class="operator">=</span><span class="operator">&amp;</span><span class="keyword">no</span>;</span><br><span class="line">  v_name  emp.ename<span class="operator">%</span>TYPE;</span><br><span class="line">  v_salary  emp.sal<span class="operator">%</span>TYPE;</span><br><span class="line">  v_comm  emp.comm<span class="operator">%</span>TYPE;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  query_emp(v_empno,v_name,v_salary,v_comm);</span><br><span class="line">  dbms_output.put_line(v_empno<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>v_name<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>v_salary<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>v_comm);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="IN-OUT参数"><a href="#IN-OUT参数" class="headerlink" title="IN OUT参数"></a>IN OUT参数</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 编写程序，交换两个变量的值并输出</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> swap</span><br><span class="line">(x <span class="keyword">IN</span> <span class="keyword">OUT</span> NUMBER ,y <span class="keyword">IN</span> <span class="keyword">OUT</span> NUMBER)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">z NUMBER;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	z:<span class="operator">=</span>x;</span><br><span class="line">	x:<span class="operator">=</span>y;</span><br><span class="line">	y:<span class="operator">=</span>z;</span><br><span class="line"><span class="keyword">END</span> swap;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 执行</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  a NUMBER:<span class="operator">=</span><span class="number">10</span>;</span><br><span class="line">  b NUMBER:<span class="operator">=</span><span class="number">20</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;交换前a和b的值是：&#x27;</span><span class="operator">||</span>a<span class="operator">||</span><span class="string">&#x27;  &#x27;</span><span class="operator">||</span>b);</span><br><span class="line">  swap(a,b);</span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;交换后a和b的值是：&#x27;</span><span class="operator">||</span>a<span class="operator">||</span><span class="string">&#x27;  &#x27;</span><span class="operator">||</span>b);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="参数的缺省值"><a href="#参数的缺省值" class="headerlink" title="参数的缺省值"></a>参数的缺省值</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例子</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> add_dept</span><br><span class="line">  (p_name <span class="keyword">IN</span> dept.dname<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="string">&#x27;unknown&#x27;</span>,</span><br><span class="line">   p_loc <span class="keyword">IN</span> dept.loc<span class="operator">%</span>TYPE  <span class="keyword">DEFAULT</span> <span class="string">&#x27;NEW YORK&#x27;</span>)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   <span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept (deptno,dname, loc)</span><br><span class="line">   <span class="keyword">VALUES</span> (dept_seq.NEXTVAL, p_name, p_loc);</span><br><span class="line"><span class="keyword">END</span> add_dept;</span><br><span class="line"><span class="comment">-- 执行</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span><span class="keyword">BEGIN</span></span><br><span class="line">               add_dept;</span><br><span class="line">               add_dept (<span class="string">&#x27;TRAINING&#x27;</span>);</span><br><span class="line">               add_dept ( p_loc <span class="operator">=</span><span class="operator">&gt;</span><span class="string">&#x27;BOSTON &#x27;</span>, p_name <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;EDUCATION&#x27;</span>);</span><br><span class="line">               add_dept ( p_loc <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&#x27;CHICAGO&#x27;</span>) ;</span><br><span class="line">              <span class="keyword">END</span>;     <span class="operator">/</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例8.4  为scott.emp表创建一个能完成插入功能的存储过程insert_emp。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> insert_emp </span><br><span class="line">(<span class="keyword">no</span> <span class="keyword">IN</span> scott.emp.empno<span class="operator">%</span>TYPE,</span><br><span class="line">    name <span class="keyword">IN</span> scott.emp.ename<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    job <span class="keyword">IN</span> scott.emp.job<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="string">&#x27;SALESMAN&#x27;</span>,</span><br><span class="line">    mgr <span class="keyword">IN</span> scott.emp.mgr<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="number">7369</span>,</span><br><span class="line">    hiredate scott.emp.hiredate<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> SYSDATE,</span><br><span class="line">    salary scott.emp.sal<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="number">800</span>,</span><br><span class="line">    comm scott.emp.comm<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    deptno scott.emp.deptno<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="number">10</span>)   <span class="keyword">IS</span></span><br><span class="line">    e_integrity EXCEPTION;</span><br><span class="line">    PRAGMA EXCEPTION_INIT (e_integrity,<span class="number">-2291</span>);</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> scott.emp <span class="keyword">VALUES</span>(<span class="keyword">no</span>,name,job,mgr,hiredate,salary,comm,deptno);</span><br><span class="line">    EXCEPTION</span><br><span class="line">        <span class="keyword">WHEN</span> DUP_VAL_ON_INDEX <span class="keyword">THEN</span>  dbms_output.put_line(<span class="string">&#x27;该员工已经存在！&#x27;</span>);</span><br><span class="line">        <span class="keyword">WHEN</span> e_integrity <span class="keyword">THEN</span>  dbms_output.put_line(<span class="string">&#x27;部门编号填写错误！&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="comment">-- 注意：在参数的定义上，除了向主键字段empno插入值的变量no没有设置默认值外，其他所有的变量都给出了默认值，这样当用户调用该存储过程时，可以指定任意个数的实参。 </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="删除过程"><a href="#删除过程" class="headerlink" title="删除过程"></a>删除过程</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> procedure_name;</span><br></pre></td></tr></table></figure>

<h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><h5 id="创建函数"><a href="#创建函数" class="headerlink" title="创建函数"></a>创建函数</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE] <span class="keyword">FUNCTION</span> function_name </span><br><span class="line">[(argument1 [<span class="keyword">IN</span> <span class="operator">|</span> <span class="keyword">OUT</span> <span class="operator">|</span> <span class="keyword">IN</span> <span class="keyword">OUT</span>] data_type , argument2 [<span class="keyword">IN</span> <span class="operator">|</span> <span class="keyword">OUT</span> <span class="operator">|</span> <span class="keyword">IN</span> <span class="keyword">OUT</span>] data­_type,…)]</span><br><span class="line"><span class="keyword">RETURN</span> data_type</span><br><span class="line"><span class="keyword">IS</span> <span class="operator">|</span><span class="keyword">AS</span></span><br><span class="line">   [declaration_section;]</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   executable_section;</span><br><span class="line">   <span class="keyword">RETURN</span> expression;</span><br><span class="line">[EXCEPTION</span><br><span class="line">   exception_handlers;</span><br><span class="line"><span class="keyword">RETURN</span> expression;</span><br><span class="line"><span class="keyword">END</span> [function_name]; </span><br><span class="line"> <span class="comment">-- return_datatype是函数返回的数值的类型，不能对数据类型的SIZE进行限定。</span></span><br><span class="line"><span class="comment">-- 在PL/SQL块中，可以使用多个RETURN语句，但是必须保证至少有一条RETURN语句存在。函数每一次运行只有一个RETURN语句被执行。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="调用函数"><a href="#调用函数" class="headerlink" title="调用函数"></a>调用函数</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例子</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">FUNCTION</span> get_sal</span><br><span class="line">      (p_id <span class="keyword">IN</span> emp.empno<span class="operator">%</span>TYPE)</span><br><span class="line"><span class="keyword">RETURN</span> NUMBER</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">      v_salary emp.sal<span class="operator">%</span>TYPE :<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">     <span class="keyword">SELECT</span> sal     <span class="keyword">INTO</span> v_salary     <span class="keyword">FROM</span> emp     <span class="keyword">WHERE</span> empno <span class="operator">=</span> p_id;</span><br><span class="line">     <span class="keyword">RETURN</span> v_salary;</span><br><span class="line"><span class="keyword">END</span> get_sal;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="执行函数"><a href="#执行函数" class="headerlink" title="执行函数"></a>执行函数</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 注意：因为函数具有返回值，所以调用函数是作为一个表达式的一部分，而不能像调用过程那样作为一个独立的语句使用。 </span></span><br><span class="line"><span class="comment">-- 方式一：SQLPLUS命令使用变量接收返回值</span></span><br><span class="line">VAR salary NUMBER;</span><br><span class="line"><span class="keyword">EXEC</span> :salary:<span class="operator">=</span>get_sal(<span class="number">7369</span>);</span><br><span class="line">PRINT salary;</span><br><span class="line"><span class="comment">-- 方式二：在SQL语句中直接调用函数</span></span><br><span class="line"><span class="keyword">SELECT</span> get_sal(<span class="number">7369</span>) <span class="keyword">FROM</span> DUAL;</span><br><span class="line"><span class="comment">-- 方式三：使用DBMS_OUTPUT调用函数（表达式运算）</span></span><br><span class="line">dbms_output.put_line(<span class="string">&#x27;工资是:&#x27;</span><span class="operator">||</span> get_sal(<span class="number">7369</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="删除函数"><a href="#删除函数" class="headerlink" title="删除函数"></a>删除函数</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> function_name;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例  创建函数，从scott.emp表中查询指定编号职工的工资。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">FUNCTION</span> select_sal</span><br><span class="line">(<span class="keyword">no</span> scott.emp.empno<span class="operator">%</span>TYPE)</span><br><span class="line"><span class="keyword">RETURN</span> scott.emp.sal<span class="operator">%</span>TYPE</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">salary scott.emp.sal<span class="operator">%</span>TYPE;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">SELECT</span> sal <span class="keyword">INTO</span> salary <span class="keyword">FROM</span> scott.emp <span class="keyword">WHERE</span> empno<span class="operator">=</span><span class="keyword">no</span>;</span><br><span class="line"><span class="keyword">RETURN</span> salary;</span><br><span class="line">EXCEPTION</span><br><span class="line"><span class="keyword">WHEN</span> NO_DATA_FOUND <span class="keyword">THEN</span></span><br><span class="line"><span class="keyword">RETURN</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例   创建函数，从scott.emp表中查询指定员编号工的工资和姓名。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">FUNCTION</span> SELECT_NAME_SAL</span><br><span class="line">(P_EMPNO <span class="keyword">IN</span> NUMBER,P_SAL <span class="keyword">OUT</span> NUMBER, P_NAME <span class="keyword">OUT</span> VARCHAR2)</span><br><span class="line"><span class="keyword">RETURN</span> NUMBER  <span class="comment">--0 表示成功 1表示异常 员工编号不存在</span></span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">V_RESULT NUMBER:<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">SELECT</span> SAL ,ENAME <span class="keyword">INTO</span> P_SAL ,P_NAME <span class="keyword">FROM</span> EMP <span class="keyword">WHERE</span> EMPNO<span class="operator">=</span> P_EMPNO;</span><br><span class="line"><span class="keyword">RETURN</span> V_RESULT;</span><br><span class="line">EXCEPTION</span><br><span class="line"><span class="keyword">WHEN</span> NO_DATA_FOUND <span class="keyword">THEN</span></span><br><span class="line">	DBMS_OUTPUT.PUT_LINE(<span class="string">&#x27;无符合要求的记录&#x27;</span>);</span><br><span class="line">  	V_RESULT:<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">	<span class="keyword">RETURN</span> V_RESULT;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>







]]></content>
      <categories>
        <category>Oracle</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>Oracle实验1</title>
    <url>/2021/11/12/Oracle%E5%AE%9E%E9%AA%8C1/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>Oracle复习8</title>
    <url>/2021/11/11/Oracle%E5%A4%8D%E4%B9%A08/</url>
    <content><![CDATA[<h3 id="分支结构"><a href="#分支结构" class="headerlink" title="分支结构"></a>分支结构</h3><h4 id="IF逻辑结构"><a href="#IF逻辑结构" class="headerlink" title="IF逻辑结构"></a>IF逻辑结构</h4><ul>
<li><strong>IF-THEN-END IF</strong></li>
<li><strong>IF-THEN-ELSE-END IF</strong></li>
<li><strong>IF-THEN-ELSIF-END IF</strong></li>
</ul>
<h5 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">IF <span class="keyword">condition</span> <span class="keyword">THEN</span></span><br><span class="line">  statements;</span><br><span class="line">[ELSIF <span class="keyword">condition</span> <span class="keyword">THEN</span> </span><br><span class="line">  statements;]</span><br><span class="line">[<span class="keyword">ELSE</span> </span><br><span class="line">  statements;]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">IF v_ename <span class="operator">=</span> <span class="string">&#x27;OSBORNE&#x27;</span> <span class="keyword">THEN</span> </span><br><span class="line">  v_mgr :<span class="operator">=</span> <span class="number">22</span>;</span><br><span class="line"><span class="keyword">END</span> IF; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">IF v_ename <span class="operator">=</span> <span class="string">&#x27;MILLER&#x27;</span> <span class="keyword">THEN</span></span><br><span class="line">  v_job :<span class="operator">=</span> <span class="string">&#x27;SALESMAN&#x27;</span>;     </span><br><span class="line">  v_deptno :<span class="operator">=</span> <span class="number">35</span>;</span><br><span class="line">  v_new_comm :<span class="operator">=</span> sal <span class="operator">*</span> <span class="number">0.20</span>; </span><br><span class="line"><span class="keyword">END</span> IF;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">If var1<span class="operator">&gt;</span><span class="number">10</span> <span class="keyword">then</span></span><br><span class="line">   if var2<span class="operator">&lt;</span>var1 <span class="keyword">then</span></span><br><span class="line">      var2:<span class="operator">=</span>var1<span class="operator">+</span><span class="number">20</span>;</span><br><span class="line">   <span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">End</span> if;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">IF v_shipdate <span class="operator">-</span> v_orderdate <span class="operator">&lt;</span> <span class="number">5</span> <span class="keyword">THEN</span>  </span><br><span class="line">  v_ship_flag :<span class="operator">=</span> <span class="string">&#x27;Acceptable&#x27;</span>;</span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">  v_ship_flag :<span class="operator">=</span> <span class="string">&#x27;Unacceptable&#x27;</span>;</span><br><span class="line"><span class="keyword">END</span> IF;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- ELSIF无匹配的END IF。</span></span><br><span class="line">IF v_start <span class="operator">&gt;</span> <span class="number">100</span> <span class="keyword">THEN</span></span><br><span class="line">  v_start :<span class="operator">=</span> <span class="number">2</span> <span class="operator">*</span> v_start;</span><br><span class="line">ELSIF v_start <span class="operator">&gt;=</span> <span class="number">50</span> <span class="keyword">THEN</span>              </span><br><span class="line">  v_start :<span class="operator">=</span> <span class="number">.5</span> <span class="operator">*</span> v_start;</span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">  v_start :<span class="operator">=</span> <span class="number">.1</span> <span class="operator">*</span> v_start;</span><br><span class="line"><span class="keyword">END</span> IF;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="CASE表达式"><a href="#CASE表达式" class="headerlink" title="CASE表达式"></a>CASE表达式</h4><ul>
<li>CASE语句是在Oracle9i中引入的逻辑控制结构。使用CASE语句与IF语句结构不同，CASE语句可以使用简单的结构，有逻辑地从数值清单中作出选择。</li>
</ul>
<h5 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CASE</span> selector</span><br><span class="line"><span class="keyword">WHEN</span> expression1 <span class="keyword">THEN</span> sequence_of_statements1;</span><br><span class="line"><span class="keyword">WHEN</span> expression2 <span class="keyword">THEN</span> sequence_of_statements2;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">WHEN</span> expressionN <span class="keyword">THEN</span> sequence_of_statementsN;</span><br><span class="line">[<span class="keyword">ELSE</span> sequence_of_statementsN<span class="operator">+</span><span class="number">1</span>;]</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line"><span class="comment">-- 注意：为了避免CASE_NOT_FOUND异常，在编写CASE语句时应该带有ELSE语句。 </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="比较IF语句和CASE语句"><a href="#比较IF语句和CASE语句" class="headerlink" title="比较IF语句和CASE语句"></a>比较IF语句和CASE语句</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">IF grade <span class="operator">=</span> <span class="string">&#x27;A&#x27;</span> <span class="keyword">THEN</span> dbms_output.put_line(<span class="string">&#x27;Excellent&#x27;</span>);</span><br><span class="line">ELSIF grade <span class="operator">=</span> <span class="string">&#x27;B&#x27;</span> <span class="keyword">THEN</span> dbms_output.put_line(<span class="string">&#x27;Very Good&#x27;</span>);</span><br><span class="line">ELSIF grade <span class="operator">=</span> <span class="string">&#x27;C&#x27;</span> <span class="keyword">THEN</span> dbms_output.put_line(<span class="string">&#x27;Good&#x27;</span>);</span><br><span class="line">ELSIF grade <span class="operator">=</span> <span class="string">&#x27;D&#x27;</span> <span class="keyword">THEN</span> dbms_output. put_line(<span class="string">&#x27;Fair&#x27;</span>);</span><br><span class="line">ELSIF grade <span class="operator">=</span> <span class="string">&#x27;E&#x27;</span> <span class="keyword">THEN</span> dbms_output.put_line(<span class="string">&#x27;Poor&#x27;</span>);</span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;No such grade&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span> IF;</span><br><span class="line"><span class="comment">----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">CASE</span> grade</span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;A&#x27;</span> <span class="keyword">THEN</span>  dbms_output.put_line(<span class="string">&#x27;Excellent&#x27;</span>);</span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;B&#x27;</span> <span class="keyword">THEN</span>  dbms_output.put_line(<span class="string">&#x27;Very Good&#x27;</span>);</span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;C&#x27;</span> <span class="keyword">THEN</span>  dbms_output.put_line(<span class="string">&#x27;Good&#x27;</span>);</span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;D&#x27;</span> <span class="keyword">THEN</span>  dbms_output.put_line(<span class="string">&#x27;Fair&#x27;</span>);</span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;E&#x27;</span> <span class="keyword">THEN</span>  dbms_output.put_line(<span class="string">&#x27;Poor&#x27;</span>);</span><br><span class="line"><span class="keyword">ELSE</span> dbms_output.put_line(<span class="string">&#x27;No such grade&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 从emp表中查询指定员工的工资，并判断该员工的工资是否低于2000，如果条件成立，那么将该员工的工资增加200</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_sal emp.sal<span class="operator">%</span>TYPE;</span><br><span class="line">  v_ename emp.ename<span class="operator">%</span>type:<span class="operator">=</span><span class="string">&#x27;&amp;ename&#x27;</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">SELECT</span> sal <span class="keyword">INTO</span> v_sal <span class="keyword">FROM</span> scott.emp</span><br><span class="line">  <span class="keyword">WHERE</span> <span class="built_in">LOWER</span>(ename)<span class="operator">=</span><span class="built_in">LOWER</span>(v_ename);</span><br><span class="line">  IF v_sal <span class="operator">&lt;</span><span class="number">2000</span> <span class="keyword">THEN</span></span><br><span class="line">      UPDATE emp <span class="keyword">SET</span> sal<span class="operator">=</span>v_sal<span class="operator">+</span><span class="number">200</span></span><br><span class="line">      <span class="keyword">WHERE</span> <span class="built_in">LOWER</span>(ename)<span class="operator">=</span><span class="built_in">LOWER</span>(v_ename);</span><br><span class="line">  <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 从emp表中查询指定员工的工作，并根据工作来修改他的工资</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_job emp.job<span class="operator">%</span>type;</span><br><span class="line">  v_sal emp.sal<span class="operator">%</span>type;</span><br><span class="line">  v_no emp.empno<span class="operator">%</span>type;</span><br><span class="line">  v_ename emp.ename<span class="operator">%</span>type;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  v_no:<span class="operator">=</span><span class="operator">&amp;</span><span class="keyword">no</span>;</span><br><span class="line">  <span class="keyword">SELECT</span> job,sal,ename <span class="keyword">INTO</span> v_job,v_sal,v_ename</span><br><span class="line">  <span class="keyword">FROM</span>  emp <span class="keyword">WHERE</span> empno<span class="operator">=</span>v_no;</span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;name:&#x27;</span><span class="operator">||</span>v_ename<span class="operator">||</span><span class="string">&#x27;job:&#x27;</span><span class="operator">||</span>v_job<span class="operator">||</span><span class="string">&#x27;sal:&#x27;</span><span class="operator">||</span>v_sal);</span><br><span class="line">  IF v_job<span class="operator">=</span><span class="string">&#x27;PRESIDENT&#x27;</span> <span class="keyword">THEN</span> </span><br><span class="line">	v_sal:<span class="operator">=</span> v_sal <span class="operator">+</span><span class="number">1000</span>; </span><br><span class="line">    UPDATE emp <span class="keyword">SET</span> sal<span class="operator">=</span>v_sal <span class="keyword">WHERE</span> empno<span class="operator">=</span>v_no;</span><br><span class="line">  ELSIF v_job<span class="operator">=</span><span class="string">&#x27;MANAGER&#x27;</span> <span class="keyword">THEN</span></span><br><span class="line">    UPDATE emp <span class="keyword">SET</span> sal<span class="operator">=</span>v_sal<span class="operator">+</span><span class="number">500</span> <span class="keyword">WHERE</span> empno<span class="operator">=</span>v_no;</span><br><span class="line">  ELSIF v_job<span class="operator">=</span><span class="string">&#x27;CLERK&#x27;</span> <span class="keyword">THEN</span></span><br><span class="line">    UPDATE emp <span class="keyword">SET</span> sal<span class="operator">=</span>v_sal<span class="operator">+</span><span class="number">200</span> <span class="keyword">where</span> empno<span class="operator">=</span>v_no;</span><br><span class="line">  <span class="keyword">ELSE</span></span><br><span class="line">    UPDATE emp <span class="keyword">SET</span> sal<span class="operator">=</span>v_sal<span class="operator">+</span><span class="number">100</span> <span class="keyword">WHERE</span> empno<span class="operator">=</span>v_no;</span><br><span class="line">  <span class="keyword">END</span> IF;</span><br><span class="line">  <span class="keyword">SELECT</span> sal <span class="keyword">INTO</span> v_sal <span class="keyword">FROM</span> scott.emp <span class="keyword">WHERE</span> empno<span class="operator">=</span>v_no;</span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;name:&#x27;</span><span class="operator">||</span>v_ename<span class="operator">||</span><span class="string">&#x27;job:&#x27;</span><span class="operator">||</span>v_job<span class="operator">||</span><span class="string">&#x27;sal:&#x27;</span><span class="operator">||</span>v_sal);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 修改emp表中指定部门的职工的奖金</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_deptno emp.deptno<span class="operator">%</span>TYPE:<span class="operator">=</span><span class="operator">&amp;</span><span class="keyword">no</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">CASE</span> v_deptno</span><br><span class="line">    <span class="keyword">WHEN</span> <span class="number">10</span> <span class="keyword">THEN</span></span><br><span class="line">      UPDATE emp <span class="keyword">SET</span> comm<span class="operator">=</span><span class="number">100</span> <span class="keyword">WHERE</span> deptno<span class="operator">=</span>v_deptno;</span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;deptno:&#x27;</span><span class="operator">||</span>v_deptno<span class="operator">||</span><span class="string">&#x27;comm:&#x27;</span><span class="operator">||</span><span class="number">100</span>);</span><br><span class="line">    <span class="keyword">WHEN</span> <span class="number">20</span> <span class="keyword">THEN</span></span><br><span class="line">      UPDATE emp <span class="keyword">SET</span> comm<span class="operator">=</span><span class="number">80</span> <span class="keyword">WHERE</span> deptno<span class="operator">=</span>v_deptno;</span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;deptno:&#x27;</span><span class="operator">||</span>v_deptno<span class="operator">||</span><span class="string">&#x27;comm:&#x27;</span><span class="operator">||</span><span class="number">80</span>);</span><br><span class="line">    <span class="keyword">WHEN</span> <span class="number">30</span> <span class="keyword">THEN</span></span><br><span class="line">      UPDATE emp <span class="keyword">SET</span> comm<span class="operator">=</span><span class="number">50</span> <span class="keyword">WHERE</span> deptno<span class="operator">=</span>v_deptno;</span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;deptno:&#x27;</span><span class="operator">||</span>v_deptno<span class="operator">||</span><span class="string">&#x27;comm:&#x27;</span><span class="operator">||</span><span class="number">50</span>);</span><br><span class="line">    <span class="keyword">ELSE</span></span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;the deptno is not exist&#x27;</span>);</span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 根据员工的工资，修改emp表中的奖金值。</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_sal emp.sal<span class="operator">%</span>TYPE;</span><br><span class="line">  v_ename emp.ename<span class="operator">%</span>TYPE;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">SELECT</span> ename,sal <span class="keyword">into</span> v_ename,v_sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empno<span class="operator">=</span><span class="operator">&amp;</span><span class="keyword">no</span>;</span><br><span class="line">  <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> v_sal<span class="operator">&lt;</span><span class="number">1000</span> <span class="keyword">THEN</span></span><br><span class="line">      UPDATE emp <span class="keyword">SET</span> comm<span class="operator">=</span><span class="number">100</span> <span class="keyword">WHERE</span> ename<span class="operator">=</span>v_ename;</span><br><span class="line">    <span class="keyword">WHEN</span> v_sal<span class="operator">&lt;</span><span class="number">2000</span> <span class="keyword">THEN</span></span><br><span class="line">      UPDATE emp <span class="keyword">SET</span> comm<span class="operator">=</span><span class="number">80</span> <span class="keyword">WHERE</span> ename<span class="operator">=</span>v_ename;</span><br><span class="line">    <span class="keyword">WHEN</span> v_sal <span class="operator">&lt;</span><span class="number">6000</span> <span class="keyword">THEN</span></span><br><span class="line">      UPDATE emp <span class="keyword">SET</span> comm<span class="operator">=</span><span class="number">50</span> <span class="keyword">WHERE</span> ename<span class="operator">=</span>v_ename;</span><br><span class="line">    <span class="keyword">ELSE</span></span><br><span class="line">      UPDATE emp <span class="keyword">SET</span> comm<span class="operator">=</span><span class="number">30</span> <span class="keyword">WHERE</span> ename<span class="operator">=</span>v_ename;</span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="循环控制结构"><a href="#循环控制结构" class="headerlink" title="循环控制结构"></a>循环控制结构</h3><ul>
<li>Loops循环是一种控制结构，允许重复执行一组命令，直到决定停止循环为止</li>
<li>三种loop循环类型:<ul>
<li><strong>Basic loop</strong></li>
<li><strong>FOR loop</strong></li>
<li><strong>WHILE loop</strong></li>
</ul>
</li>
</ul>
<h4 id="Basic-Loop"><a href="#Basic-Loop" class="headerlink" title="Basic Loop"></a>Basic Loop</h4><h5 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">LOOP              <span class="comment">-- 以循环关键字Loop开始循环        </span></span><br><span class="line">  statement1;     <span class="comment">-- 可执行语句</span></span><br><span class="line">  . . .</span><br><span class="line">  EXIT [<span class="keyword">WHEN</span> <span class="keyword">condition</span>]; <span class="comment">-- 满足条件退出循环[条件语句]</span></span><br><span class="line">  statement2;          </span><br><span class="line"><span class="keyword">END</span> LOOP;                <span class="comment">-- 关键字End Loop结束循环</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 上面的condition条件		是一个Boolean变量或表达式(TRUE、FALSE或NULL);</span></span><br></pre></td></tr></table></figure>

<h5 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 给定任意一个整数，计算该数的阶乘</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_num NUMBER(<span class="number">2</span>):<span class="operator">=</span><span class="operator">&amp;</span>num;  <span class="comment">--用户任意给定的一个整数</span></span><br><span class="line">  v_pro NUMBER(<span class="number">20</span>):<span class="operator">=</span><span class="number">1</span>;  </span><br><span class="line">  i NUMBER(<span class="number">2</span>):<span class="operator">=</span><span class="number">1</span>;  <span class="comment">--控制循环结束的循环变量</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  IF v_num<span class="operator">=</span><span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">    v_pro:<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">  <span class="keyword">ELSE</span></span><br><span class="line">    LOOP</span><br><span class="line">      v_pro:<span class="operator">=</span>v_pro<span class="operator">*</span>i;  <span class="comment">--计算给定整数的阶乘</span></span><br><span class="line">      i:<span class="operator">=</span>i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">      EXIT <span class="keyword">WHEN</span> i<span class="operator">&gt;</span>v_num;</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line">  <span class="keyword">END</span> IF;</span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;num:&#x27;</span><span class="operator">||</span>v_num<span class="operator">||</span><span class="string">&#x27;  factorial:&#x27;</span><span class="operator">||</span>v_pro);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="FOR-Loop"><a href="#FOR-Loop" class="headerlink" title="FOR Loop"></a>FOR Loop</h4><h5 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FOR</span> counter <span class="keyword">in</span> [REVERSE] </span><br><span class="line">    lower_bound..upper_bound LOOP  </span><br><span class="line">  statement1;</span><br><span class="line">  statement2;</span><br><span class="line">  . . .</span><br><span class="line"><span class="keyword">END</span> LOOP;</span><br></pre></td></tr></table></figure>

<h5 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用FOR循环实现某数的阶乘</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_num NUMBER(<span class="number">2</span>):<span class="operator">=</span><span class="operator">&amp;</span>num;</span><br><span class="line">  v_pro NUMBER(<span class="number">20</span>):<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  IF v_num<span class="operator">=</span><span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">    v_pro:<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">  <span class="keyword">ELSE</span></span><br><span class="line">    <span class="keyword">FOR</span> i <span class="keyword">IN</span> <span class="number">1.</span>.v_num LOOP</span><br><span class="line">      v_pro:<span class="operator">=</span>v_pro<span class="operator">*</span>i;      </span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line">  <span class="keyword">END</span> IF;</span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;num:&#x27;</span><span class="operator">||</span>v_num<span class="operator">||</span><span class="string">&#x27;  factorial:&#x27;</span><span class="operator">||</span>v_pro);</span><br><span class="line">  <span class="comment">--dbms_output.put(&#x27;num:&#x27;||v_num);</span></span><br><span class="line">  <span class="comment">--dbms_output.put_line(&#x27;  factorial:&#x27;||v_pro);</span></span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h4 id="While-Loop"><a href="#While-Loop" class="headerlink" title="While Loop"></a>While Loop</h4><h5 id="语法-4"><a href="#语法-4" class="headerlink" title="语法"></a>语法</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">WHILE <span class="keyword">condition</span> LOOP</span><br><span class="line">  statement1;</span><br><span class="line">  statement2;</span><br><span class="line">  . . .</span><br><span class="line"><span class="keyword">END</span> LOOP;</span><br></pre></td></tr></table></figure>

<h5 id="例子-2"><a href="#例子-2" class="headerlink" title="例子"></a>例子</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用WHILE循环实现某数的阶乘</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_num NUMBER(<span class="number">2</span>):<span class="operator">=</span><span class="operator">&amp;</span>num;</span><br><span class="line">  v_pro NUMBER(<span class="number">20</span>):<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">  i NUMBER(<span class="number">2</span>):<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  IF v_num<span class="operator">=</span><span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">    v_pro:<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">  <span class="keyword">ELSE</span></span><br><span class="line">    WHILE i<span class="operator">&lt;=</span>v_num LOOP</span><br><span class="line">      v_pro:<span class="operator">=</span>v_pro<span class="operator">*</span>i; </span><br><span class="line">      i:<span class="operator">=</span>i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line">  <span class="keyword">END</span> IF;</span><br><span class="line">  dbms_output.put_line(<span class="string">&#x27;num:&#x27;</span><span class="operator">||</span>v_num<span class="operator">||</span><span class="string">&#x27;  factorial:&#x27;</span><span class="operator">||</span>v_pro);</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="游标-Cursors"><a href="#游标-Cursors" class="headerlink" title="游标(Cursors)"></a>游标(Cursors)</h3><h4 id="隐式游标"><a href="#隐式游标" class="headerlink" title="隐式游标"></a>隐式游标</h4><p><img src="1-13.png"></p>
<h5 id="例子-3"><a href="#例子-3" class="headerlink" title="例子"></a>例子</h5><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 从表rooms中删除指定的room_id行，并打印删除的行数</span></span><br><span class="line"><span class="keyword">set</span> serveroutput <span class="keyword">on</span>;</span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_empno  NUMBER :<span class="operator">=</span> <span class="number">7788</span>;</span><br><span class="line">  rows_deleted VARCHAR2(<span class="number">100</span>);</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DELETE</span>   <span class="keyword">FROM</span> emp</span><br><span class="line">  <span class="keyword">WHERE</span>    empno <span class="operator">=</span> v_empno;</span><br><span class="line">  rows_deleted :<span class="operator">=</span> <span class="keyword">SQL</span><span class="operator">%</span>ROWCOUNT<span class="operator">||</span><span class="string">&#x27; rows deleted.&#x27;</span>;</span><br><span class="line">  dbms_output.put_line(rows_deleted);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="显示游标"><a href="#显示游标" class="headerlink" title="显示游标"></a>显示游标</h4><p><img src="1-14.png"></p>
<p><img src="1-15.png"></p>
<h5 id="声明游标"><a href="#声明游标" class="headerlink" title="声明游标"></a>声明游标</h5><ul>
<li><p>语法</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CURSOR</span> cursor_name <span class="keyword">IS</span></span><br><span class="line">     select_statement; </span><br></pre></td></tr></table></figure>

<ul>
<li>在游标声明中<strong>不能包含INTO子句</strong></li>
<li>如果处理的行<strong>要求特定的顺序</strong>，在查询语句中可以<strong>使用 ORDER BY子句</strong>。</li>
</ul>
</li>
<li><p>例子</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  <span class="keyword">CURSOR</span> c1 <span class="keyword">IS</span> </span><br><span class="line">    <span class="keyword">SELECT</span> empno, ename</span><br><span class="line">	    <span class="keyword">FROM</span>   emp;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CURSOR</span> c2 <span class="keyword">IS</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">    <span class="keyword">FROM</span>   dept</span><br><span class="line">    <span class="keyword">WHERE</span>  deptno <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="打开游标"><a href="#打开游标" class="headerlink" title="打开游标"></a>打开游标</h5><ul>
<li><p>语法</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">OPEN</span>		cursor_name;                    </span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>打开游标</strong></p>
<ol>
<li><p><strong>执行查询。</strong></p>
</li>
<li><p><strong>活动集（查询结果的行的集合）被确定。</strong></p>
</li>
<li><p><strong>活动集的指针指向第一行。</strong></p>
</li>
</ol>
<ul>
<li><p><strong>如果查询没有返回行，不会抛出异常。</strong></p>
</li>
<li><p><strong>提取一行后，应该使用游标属性测试结果。</strong></p>
</li>
</ul>
<h5 id="提取数据"><a href="#提取数据" class="headerlink" title="提取数据"></a>提取数据</h5><ul>
<li><p>语法</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FETCH</span> cursor_name <span class="keyword">INTO</span>	[variable1, variable2, ...]</span><br><span class="line">									<span class="operator">|</span> record_name];   </span><br></pre></td></tr></table></figure></li>
<li><p>例子</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_ename  emp.ename<span class="operator">%</span>TYPE;</span><br><span class="line">  v_sal    emp.sal<span class="operator">%</span>TYPE;</span><br><span class="line">  v_empRecord  emp<span class="operator">%</span>ROWTYPE;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CURSOR</span> cur_AllEmp <span class="keyword">IS</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span>  <span class="keyword">FROM</span> emp;  </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">OPEN</span> cur_AllEmp;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">FETCH</span> cur_AllEmp <span class="keyword">INTO</span> v_empRecord;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">FETCH</span> cur_AllEmp <span class="keyword">INTO</span> v_ename, v_sal; <span class="comment">-- 错误</span></span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例子: 从scott.emp表中查询所有记录，利用游标获取前两行记录并输出ename、job、sal中的值 </span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line"><span class="keyword">CURSOR</span> c1 <span class="keyword">IS</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line">emp_rec emp<span class="operator">%</span>ROWTYPE;  <span class="comment">--定义一个和表结构完全一致的记录变量</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   <span class="keyword">OPEN</span> c1;</span><br><span class="line">   <span class="keyword">FETCH</span> c1 <span class="keyword">INTO</span> emp_rec;</span><br><span class="line">   dbms_output.put_line(<span class="string">&#x27;姓名是:&#x27;</span><span class="operator">||</span>emp_rec.ename<span class="operator">||</span> <span class="string">&#x27;工作是:&#x27;</span><span class="operator">||</span>emp_rec.job<span class="operator">||</span> <span class="string">&#x27;工资是:&#x27;</span><span class="operator">||</span>emp_rec.sal);</span><br><span class="line">   <span class="keyword">FETCH</span> c1 <span class="keyword">INTO</span> emp_rec;</span><br><span class="line">   dbms_output.put_line(<span class="string">&#x27;姓名是:&#x27;</span><span class="operator">||</span>emp_rec.ename<span class="operator">||</span><span class="string">&#x27;工作是:&#x27;</span><span class="operator">||</span>emp_rec.job<span class="operator">||</span> <span class="string">&#x27;工资是:&#x27;</span><span class="operator">||</span>emp_rec.sal);</span><br><span class="line">   <span class="keyword">CLOSE</span> c1;</span><br><span class="line"><span class="keyword">END</span>; </span><br><span class="line"></span><br></pre></td></tr></table></figure>



<hr>
</li>
</ul>
<h5 id="关闭游标"><a href="#关闭游标" class="headerlink" title="关闭游标"></a>关闭游标</h5><ul>
<li><p>语法</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CLOSE</span>		cursor_name;                    </span><br></pre></td></tr></table></figure>

<ul>
<li>当所有的活动集都被检索以后，游标就应该关闭</li>
<li>如果需要，可以在重新打开游标</li>
<li>一旦关闭了游标，再从该游标提取数据就将是非法的。这样做会产生一个Oracle错误</li>
</ul>
<h5 id="显示游标的属性"><a href="#显示游标的属性" class="headerlink" title="显示游标的属性"></a>显示游标的属性</h5></li>
</ul>
<p>![1-16.png]</p>
<h5 id="游标提取BASIC-LOOP和WHILE-LOOP"><a href="#游标提取BASIC-LOOP和WHILE-LOOP" class="headerlink" title="游标提取BASIC LOOP和WHILE LOOP"></a>游标提取BASIC LOOP和WHILE LOOP</h5><ul>
<li><p>例子</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用游标实现逐行输出scott.emp表中部门编号为10的员工姓名和工资。</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">   <span class="keyword">CURSOR</span> emp_cursor <span class="keyword">IS</span> </span><br><span class="line">	<span class="keyword">SELECT</span> ename,sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno<span class="operator">=</span><span class="number">10</span>;</span><br><span class="line">   emp_record emp<span class="operator">%</span>ROWTYPE;  </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   <span class="keyword">OPEN</span> emp_cursor ;</span><br><span class="line">   LOOP</span><br><span class="line">      <span class="keyword">FETCH</span> emp_cursor <span class="keyword">INTO</span> emp_record.ename,emp_record.sal;</span><br><span class="line">      EXIT <span class="keyword">WHEN</span> emp_cursor<span class="operator">%</span>NOTFOUND;</span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;ename: &#x27;</span><span class="operator">||</span>emp_record.ename<span class="operator">||</span><span class="string">&#x27;  sal:&#x27;</span><span class="operator">||</span>emp_record.sal);</span><br><span class="line">   <span class="keyword">END</span> LOOP;</span><br><span class="line">   dbms_output.put_line(<span class="string">&#x27;row count:&#x27;</span><span class="operator">||</span>emp_cursor<span class="operator">%</span>rowcount);</span><br><span class="line">   <span class="keyword">CLOSE</span> emp_cursor;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用游标实现逐行输出scott.emp表中部门编号为10的员工姓名和工资。</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">   <span class="keyword">CURSOR</span> emp_cursor <span class="keyword">IS</span> </span><br><span class="line">	<span class="keyword">SELECT</span> ename,sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno<span class="operator">=</span><span class="number">10</span>;</span><br><span class="line">   emp_record emp<span class="operator">%</span>ROWTYPE;  </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   <span class="keyword">OPEN</span> emp_cursor ;</span><br><span class="line">   <span class="keyword">FETCH</span> emp_cursor <span class="keyword">INTO</span> emp_record.ename,emp_record.sal;</span><br><span class="line">   while emp_cursor<span class="operator">%</span>FOUND LOOP</span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;ename: &#x27;</span><span class="operator">||</span>emp_record.ename<span class="operator">||</span><span class="string">&#x27;  sal:&#x27;</span><span class="operator">||</span>emp_record.sal);</span><br><span class="line">      <span class="keyword">FETCH</span> emp_cursor <span class="keyword">INTO</span> emp_record.ename,emp_record.sal;</span><br><span class="line">   <span class="keyword">END</span> LOOP;</span><br><span class="line">   dbms_output.put_line(<span class="string">&#x27;row count:&#x27;</span><span class="operator">||</span>emp_cursor<span class="operator">%</span>rowcount);</span><br><span class="line">   <span class="keyword">CLOSE</span> emp_cursor;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="游标提取FOR-LOOP"><a href="#游标提取FOR-LOOP" class="headerlink" title="游标提取FOR LOOP"></a>游标提取FOR LOOP</h5></li>
<li><p><strong>语法</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FOR</span> record_name <span class="keyword">IN</span> cursor_name LOOP   </span><br><span class="line">  statement1;</span><br><span class="line">  statement2;</span><br><span class="line">  . . .</span><br><span class="line"><span class="keyword">END</span> LOOP;</span><br></pre></td></tr></table></figure>

<ul>
<li>游标的FOR循环能够便捷的处理显示游标。</li>
<li>FOR循环中的循环控制变量不需要事先定义。</li>
<li>在游标的FOR循环之前，系统能够自动打开游标；在FOR循环结束后，系统能够自动关闭游标，不需要人为操作。</li>
<li>在游标的FOR循环过程中，系统能够自动执行FETCH语句；每一次循环，系统就自动执行一次FETCH语句，将游标指向的当前行记录存入循环控制变量中</li>
</ul>
</li>
<li><p>例子</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例子 使用FOR循环实现逐行输出emp表中部门编号为10的员工姓名和工资。</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">   <span class="keyword">CURSOR</span> emp_cursor <span class="keyword">IS</span> </span><br><span class="line">	<span class="keyword">SELECT</span> ename,sal <span class="keyword">FROM</span> scott.emp <span class="keyword">WHERE</span> deptno<span class="operator">=</span><span class="number">10</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   <span class="keyword">FOR</span> emp_record <span class="keyword">IN</span> emp_cursor LOOP</span><br><span class="line"></span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;ename: &#x27;</span><span class="operator">||</span>emp_record.ename<span class="operator">||</span><span class="string">&#x27;  sal:&#x27;</span><span class="operator">||</span>emp_record.sal);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">END</span> LOOP;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 该命令无效，因为FOR循环结束后游标自动关闭</span></span><br><span class="line"><span class="comment">dbms_output.put_line(&#x27;row count:&#x27;||emp_cursor%rowcount); */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例子 使用游标查询emp表中的所有记录，并在程序块中输出工资最高的前五行记录</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">   <span class="keyword">CURSOR</span> cur <span class="keyword">IS</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> scott.emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> sal <span class="keyword">DESC</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   <span class="keyword">FOR</span> rec <span class="keyword">IN</span> cur  LOOP</span><br><span class="line">      IF cur<span class="operator">%</span>ROWCOUNT<span class="operator">&lt;=</span><span class="number">5</span> <span class="keyword">THEN</span></span><br><span class="line">                dbms_output.put_line(<span class="string">&#x27;ename:&#x27;</span><span class="operator">||</span>rec.ename<span class="operator">||</span>’sal:<span class="string">&#x27;||rec.sal);</span></span><br><span class="line"><span class="string">      ELSE </span></span><br><span class="line"><span class="string">        EXIT;</span></span><br><span class="line"><span class="string">      END IF;</span></span><br><span class="line"><span class="string">   END LOOP;</span></span><br><span class="line"><span class="string">END;</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="带参数的游标"><a href="#带参数的游标" class="headerlink" title="带参数的游标"></a>带参数的游标</h5><ul>
<li><p>语法</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CURSOR</span> cursor_name(parameter_name datatype) <span class="keyword">IS</span> select_statment; </span><br></pre></td></tr></table></figure>

<ul>
<li>使用open命令打开带参数的游标时，需要给游标传递实参值。</li>
</ul>
</li>
<li><p>例子</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例子   定义参数游标，查询指定部门的员工姓名</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line"><span class="comment">--定义游标参数no，参数类型为number类型</span></span><br><span class="line"><span class="keyword">CURSOR</span> emp_cursor( <span class="keyword">no</span> NUMBER) <span class="keyword">IS</span> </span><br><span class="line">		<span class="keyword">SELECT</span> ename <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> deptno<span class="operator">=</span><span class="keyword">no</span>;</span><br><span class="line">emp_rec emp_cursor<span class="operator">%</span>ROWTYPE;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="comment">--打开参数游标时，指明一个替代变量作为游标参数的值</span></span><br><span class="line">  <span class="keyword">OPEN</span> emp_cursor(<span class="operator">&amp;</span><span class="keyword">no</span>); </span><br><span class="line">  LOOP</span><br><span class="line">    <span class="keyword">FETCH</span> emp_cursor <span class="keyword">INTO</span> emp_rec;</span><br><span class="line">    EXIT <span class="keyword">WHEN</span> emp_cursor<span class="operator">%</span>NOTFOUND;     </span><br><span class="line">    dbms_output.put_line(<span class="string">&#x27;ename:&#x27;</span><span class="operator">||</span>emp_rec.ename);</span><br><span class="line">  <span class="keyword">END</span> LOOP;</span><br><span class="line">  <span class="keyword">CLOSE</span> emp_cursor;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h3><h4 id="异常处理语法"><a href="#异常处理语法" class="headerlink" title="异常处理语法"></a>异常处理语法</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">EXCEPTION</span><br><span class="line">  <span class="keyword">WHEN</span> exception1 [<span class="keyword">OR</span> exception2 . . .] <span class="keyword">THEN</span></span><br><span class="line">    statement1;</span><br><span class="line">    statement2;</span><br><span class="line">    . . .</span><br><span class="line">  [<span class="keyword">WHEN</span> exception3 [<span class="keyword">OR</span> exception4 . . .] <span class="keyword">THEN</span></span><br><span class="line">    statement1;</span><br><span class="line">    statement2;</span><br><span class="line">    . . .]</span><br><span class="line">  [<span class="keyword">WHEN</span> OTHERS <span class="keyword">THEN</span></span><br><span class="line">    statement1;</span><br><span class="line">    statement2;</span><br><span class="line">    . . .]</span><br></pre></td></tr></table></figure>

<h4 id="捕获异常规则"><a href="#捕获异常规则" class="headerlink" title="捕获异常规则"></a>捕获异常规则</h4><ul>
<li>WHEN OTHERS用于捕获所有未指定错误。必须是最后一个错误处理语句</li>
<li>EXCEPTION关键字，标识异常处理的开始区域</li>
<li>允许有多个异常处理子句。</li>
<li>在离开异常处理程序块之前，只能有一个错误处理子句被执行。</li>
</ul>
<h4 id="异常的类型"><a href="#异常的类型" class="headerlink" title="异常的类型"></a>异常的类型</h4><p>隐式触发</p>
<ul>
<li>系统预定义异常</li>
<li>系统非预定义异常</li>
</ul>
<p>显示触发</p>
<ul>
<li>用户自定义异常</li>
</ul>
<h5 id="系统预定义异常"><a href="#系统预定义异常" class="headerlink" title="系统预定义异常"></a>系统预定义异常</h5><p><img src="1-17.png"></p>
<ul>
<li><p>语法</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>  <span class="keyword">SELECT</span> ... <span class="keyword">COMMIT</span>;</span><br><span class="line">EXCEPTION</span><br><span class="line">  <span class="keyword">WHEN</span> NO_DATA_FOUND <span class="keyword">THEN</span></span><br><span class="line">    statement1; </span><br><span class="line">    statement2; 						         </span><br><span class="line">  <span class="keyword">WHEN</span> TOO_MANY_ROWS <span class="keyword">THEN</span></span><br><span class="line">    statement1;</span><br><span class="line">  <span class="keyword">WHEN</span> OTHERS <span class="keyword">THEN</span></span><br><span class="line">    statement1; </span><br><span class="line">    statement2; </span><br><span class="line">    statement3;</span><br><span class="line"><span class="keyword">END</span>;	</span><br></pre></td></tr></table></figure></li>
<li><p>例子</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  v_empRecord  emp<span class="operator">%</span>ROWTYPE; </span><br><span class="line">  v_empNo      emp.empno<span class="operator">%</span>TYPE; </span><br><span class="line"><span class="keyword">BEGIN</span>  </span><br><span class="line">  <span class="keyword">SELECT</span> <span class="operator">*</span>  <span class="keyword">INTO</span> v_empRecord  <span class="keyword">FROM</span> emp;</span><br><span class="line">  <span class="comment">--SELECT *  INTO v_empRecord  FROM emp  WHERE empno = 12345789 ;</span></span><br><span class="line">  <span class="comment">--SELECT ename  INTO v_empNo  FROM emp  WHERE empno = 7369;</span></span><br><span class="line">  EXCEPTION</span><br><span class="line">    <span class="keyword">WHEN</span> TOO_MANY_ROWS <span class="keyword">THEN</span></span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;TOO_MANY_ROWS EXCEPTION&#x27;</span>); </span><br><span class="line">    <span class="keyword">WHEN</span> NO_DATA_FOUND <span class="keyword">THEN</span></span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;NO_DATA_FOUND EXCEPTION&#x27;</span>); </span><br><span class="line">    <span class="keyword">WHEN</span> OTHERS <span class="keyword">THEN</span></span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;OTHERS EXCEPTION&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="系统非预定义异常"><a href="#系统非预定义异常" class="headerlink" title="系统非预定义异常"></a>系统非预定义异常</h5><ul>
<li><p>捕获Oracle服务器错误</p>
</li>
<li><p>将数字-2291与e_products_invalid相关联。（-2291表示违反了完整性约束）</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">  e_products_invalid	EXCEPTION;</span><br><span class="line">  PRAGMA EXCEPTION_INIT (</span><br><span class="line">		e_products_invalid, <span class="number">-2292</span>);</span><br><span class="line">  v_message VARCHAR2(<span class="number">50</span>);</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">. . .</span><br><span class="line">EXCEPTION</span><br><span class="line">  <span class="keyword">WHEN</span> e_products_invalid <span class="keyword">THEN</span></span><br><span class="line">    :g_message :<span class="operator">=</span> <span class="string">&#x27;Product code</span></span><br><span class="line"><span class="string">		specified is not valid.&#x27;</span>;</span><br><span class="line">. . .</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<ul>
<li><p>例子</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 为emp表创建一个能完成插入功能的存储过程insert_emp。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">PROCEDURE</span> insert_emp </span><br><span class="line">(<span class="keyword">no</span> <span class="keyword">IN</span> emp.empno<span class="operator">%</span>TYPE,   name <span class="keyword">IN</span> emp.ename<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">job <span class="keyword">IN</span> emp.job<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="string">&#x27;SALESMAN&#x27;</span>,</span><br><span class="line">mgr <span class="keyword">IN</span> emp.mgr<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="number">7369</span>,</span><br><span class="line">hiredate emp.hiredate<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> SYSDATE,</span><br><span class="line">salary emp.sal<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="number">800</span>,</span><br><span class="line">comm emp.comm<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">deptno emp.deptno<span class="operator">%</span>TYPE <span class="keyword">DEFAULT</span> <span class="number">10</span></span><br><span class="line">)<span class="keyword">IS</span></span><br><span class="line">e_integrity EXCEPTION;</span><br><span class="line">PRAGMA EXCEPTION_INIT (e_integrity,<span class="number">-2291</span>);</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">     <span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span>(<span class="keyword">no</span>,name,job,mgr,hiredate,salary,comm,deptno);</span><br><span class="line">EXCEPTION</span><br><span class="line">    <span class="keyword">WHEN</span> DUP_VAL_ON_INDEX <span class="keyword">THEN</span></span><br><span class="line">        dbms_output.put_line(<span class="string">&#x27;该员工已经存在！&#x27;</span>);</span><br><span class="line">    <span class="keyword">WHEN</span> e_integrity <span class="keyword">THEN</span></span><br><span class="line">        dbms_output.put_line(<span class="string">&#x27;部门编号填写错误！&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="用户自定义异常"><a href="#用户自定义异常" class="headerlink" title="用户自定义异常"></a>用户自定义异常</h4><ul>
<li><p>例子</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">[<span class="keyword">DECLARE</span>]</span><br><span class="line">  e_amount_remaining EXCEPTION;</span><br><span class="line">. . .</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">. . .</span><br><span class="line">  RAISE e_amount_remaining;</span><br><span class="line">. . .</span><br><span class="line">EXCEPTION</span><br><span class="line">  <span class="keyword">WHEN</span> e_amount_remaining  <span class="keyword">THEN</span></span><br><span class="line">    :g_message :<span class="operator">=</span> <span class="string">&#x27;There is still an amount</span></span><br><span class="line"><span class="string">	             in stock.&#x27;</span>;</span><br><span class="line">. . .</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 例子： 向emp表中插入一条新记录，在执行的过程中捕获系统预定义异常、系统非预定义异常、用户自定义异常，并分别作相应的处理。 </span></span><br><span class="line"><span class="keyword">DECLARE</span>  </span><br><span class="line">  ex_null EXCEPTION; <span class="comment">--系统非预定义异常的定义和关联</span></span><br><span class="line">  PRAGMA EXCEPTION_INIT(ex_null,<span class="number">-01400</span>);  </span><br><span class="line">  ex_insert EXCEPTION; <span class="comment">--用户自定义异常的定义  </span></span><br><span class="line">  eno scott.emp.empno<span class="operator">%</span>TYPE:<span class="operator">=</span><span class="operator">&amp;</span><span class="keyword">no</span>; <span class="comment">--定义程序块变量</span></span><br><span class="line">  e_sal scott.emp.sal<span class="operator">%</span>TYPE:<span class="operator">=</span><span class="operator">&amp;</span>salary;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  IF e_sal<span class="operator">&gt;</span><span class="number">10000</span> <span class="keyword">THEN</span></span><br><span class="line">    RAISE ex_insert;  <span class="comment">--用户自定义异常的触发</span></span><br><span class="line">  <span class="keyword">END</span> IF;</span><br><span class="line">  <span class="keyword">INSERT</span> <span class="keyword">INTO</span> scott.emp(empno,sal) <span class="keyword">VALUES</span>(eno,e_sal);</span><br><span class="line">  EXCEPTION</span><br><span class="line">    <span class="keyword">WHEN</span> DUP_VAL_ON_INDEX  <span class="keyword">THEN</span>   <span class="comment">--系统预定义异常的捕获和处理</span></span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;该员工已经存在！&#x27;</span>);</span><br><span class="line">    <span class="keyword">WHEN</span> ex_null <span class="keyword">THEN</span>   <span class="comment">--系统非预定义异常的捕获和处理</span></span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;职工编号不能为空！&#x27;</span>);</span><br><span class="line">    <span class="keyword">WHEN</span> ex_insert <span class="keyword">THEN</span>   <span class="comment">--用户自定义异常的捕获和处理</span></span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;员工的工资不能超过10000！&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>Oracle</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>Oracle实验2</title>
    <url>/2021/11/12/Oracle%E5%AE%9E%E9%AA%8C2/</url>
    <content><![CDATA[<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 编写SQL创建视图v_getTeacherbyDeptID，获取信息技术学院及其下属部门的所有教师信息。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> v_getTeacherbyDeptID;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_getTeacherbyDeptID <span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> teacher </span><br><span class="line"><span class="keyword">where</span> dept_id <span class="keyword">in</span> (</span><br><span class="line"><span class="keyword">select</span> dept_id <span class="keyword">from</span> dept</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">with</span> dept_name <span class="operator">=</span> <span class="string">&#x27;信息技术学院&#x27;</span></span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> prior dept_id <span class="operator">=</span> parent_id</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v_getTeacherbyDeptID; </span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 编写SQL创建视图v_getTeacherCountbyProfess，统计各个职称级别的教师人数。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> v_getTeacherCountbyProfess;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_getTeacherCountbyProfess <span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) &quot;教师人数&quot; , decode(profess,<span class="string">&#x27;教授&#x27;</span>,<span class="string">&#x27;1-教授&#x27;</span>,</span><br><span class="line">                         <span class="string">&#x27;副教授&#x27;</span>,<span class="string">&#x27;2-副教授&#x27;</span>,</span><br><span class="line">                         <span class="string">&#x27;讲师&#x27;</span>,<span class="string">&#x27;3-讲师&#x27;</span>,</span><br><span class="line">                         <span class="string">&#x27;助教&#x27;</span>,<span class="string">&#x27;4-助教&#x27;</span>) &quot;职称级别&quot; <span class="keyword">from</span> teacher <span class="keyword">group</span> <span class="keyword">by</span> profess <span class="keyword">order</span> <span class="keyword">by</span> &quot;职称级别&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v_getTeacherCountbyProfess;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 编写SQL创建视图v_getCourseCountbyTeacher，统计任课表中各教师的授课数。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> v_getCourseCountbyTeacher;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_getCourseCountbyTeacher <span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span> (<span class="operator">*</span>) &quot;课程数&quot;, teacher_id &quot;教师编号&quot;,(<span class="keyword">select</span> tname <span class="keyword">from</span> teacher <span class="keyword">where</span> teacher.teacher_id <span class="operator">=</span> tc.teacher_id)&quot;教师姓名&quot; <span class="keyword">from</span> tc </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>  tc.teacher_id; </span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v_getCourseCountbyTeacher;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 编写SQL创建视图v_getCourseCountForAllTeachers，统计所有教师的授课数。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> v_getCourseCountForAllTeachers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> v_getCourseCountForAllTeachers</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> a.<span class="operator">*</span>,b.c &quot;授课数&quot; <span class="keyword">from</span> teacher a,</span><br><span class="line">(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) c,teacher_id <span class="keyword">from</span> tc <span class="keyword">group</span> <span class="keyword">by</span> teacher_id) b</span><br><span class="line"><span class="keyword">where</span> a.teacher_id<span class="operator">=</span> b.teacher_id(<span class="operator">+</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v_getCourseCountForAllTeachers;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Oracle</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>Oracle实验3</title>
    <url>/2021/11/12/Oracle%E5%AE%9E%E9%AA%8C3/</url>
    <content><![CDATA[<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- (1）创建“添加教师信息”的匿名块，将输入信息插入教师信息表。</span></span><br><span class="line"><span class="comment">-- （2）“添加教师信息”的匿名块的程序框架如下：</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="comment">-- 定义接受每个字段数据的变量									</span></span><br><span class="line">  <span class="comment">-- 定义NOTNULL字段输入为null时抛出的用户自定义异常变量	</span></span><br><span class="line">  <span class="comment">-- 定义输入系部代码在部门信息表中不存在时抛出的用户自定义异常变量</span></span><br><span class="line">   <span class="comment">-- 定义其他临时变量</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 如果NOTNULL字段输入为null，抛出用户自定义异常			 </span></span><br><span class="line">  <span class="comment">-- 查询输入系部代码在部门信息表中的记录数；如果记录数为0，抛出用户自定义异常</span></span><br><span class="line"><span class="comment">-- 检查性别是不是男/女，不是则输出提示信息&#x27;性别不正确！&#x27;，是则继续。</span></span><br><span class="line">  <span class="comment">-- insert语句插入教师信息记录									 </span></span><br><span class="line">  <span class="comment">-- 输出提示信息&#x27;教师信息添加成功！&#x27;</span></span><br><span class="line">EXCEPTION</span><br><span class="line">    <span class="comment">-- 处理NOTNULL字段输入为null的用户自定义异常，输出提示信息 </span></span><br><span class="line">    <span class="comment">-- 处理系部代码不存在的用户自定义异常，输出提示信息 </span></span><br><span class="line">    <span class="comment">-- 处理教师编号已经存在产生的系统预定义异常，输出提示信息  </span></span><br><span class="line">    <span class="comment">-- 处理其他异常，输出提示信息</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- lab2</span></span><br><span class="line"><span class="keyword">set</span> serveroutput <span class="keyword">on</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建“添加教师信息”的匿名块，将输入信息插入教师信息表。 </span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">v_id teacher.teacher_id<span class="operator">%</span>type :<span class="operator">=</span> <span class="string">&#x27;&amp;教师编号&#x27;</span>;</span><br><span class="line">v_name teacher.tname<span class="operator">%</span>type :<span class="operator">=</span> <span class="string">&#x27;&amp;教师姓名&#x27;</span>;</span><br><span class="line">v_sex teacher.tsex<span class="operator">%</span>type :<span class="operator">=</span> <span class="string">&#x27;&amp;教师性别&#x27;</span>;</span><br><span class="line">v_birth teacher.tbirth<span class="operator">%</span>type :<span class="operator">=</span> to_date(<span class="string">&#x27;&amp;教师出生日期&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD&#x27;</span>);</span><br><span class="line">v_educ teacher.educ<span class="operator">%</span>type :<span class="operator">=</span> <span class="string">&#x27;&amp;教师学历&#x27;</span>;</span><br><span class="line">v_profess teacher.profess<span class="operator">%</span>type :<span class="operator">=</span> <span class="string">&#x27;&amp;教师职称&#x27;</span>;</span><br><span class="line">v_dept_id teacher.dept_id<span class="operator">%</span>type :<span class="operator">=</span> <span class="string">&#x27;&amp;系部代码&#x27;</span>;</span><br><span class="line">ex_null exception;</span><br><span class="line">ex_dept_no_exist exception;</span><br><span class="line">v_count number;</span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">    if <span class="built_in">trim</span>(v_id) <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> <span class="built_in">trim</span>(v_name) <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> <span class="built_in">trim</span>(v_sex)<span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> <span class="built_in">trim</span>(v_birth) <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> <span class="built_in">trim</span>(v_educ) <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> <span class="built_in">trim</span>(v_profess)<span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> <span class="built_in">trim</span>(v_dept_id)<span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> </span><br><span class="line">      raise ex_null ;</span><br><span class="line">    <span class="keyword">end</span> if;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">into</span> v_count <span class="keyword">from</span> dept <span class="keyword">where</span> dept_id <span class="operator">=</span> v_dept_id;</span><br><span class="line">    if v_count <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line">      raise ex_dept_no_exist;</span><br><span class="line">    <span class="keyword">end</span> if;</span><br><span class="line">    if v_sex <span class="operator">!=</span> <span class="string">&#x27;男&#x27;</span> <span class="keyword">and</span> v_sex<span class="operator">!=</span><span class="string">&#x27;女&#x27;</span> <span class="keyword">then</span> </span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;性别不正确！&#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="keyword">insert</span> <span class="keyword">into</span> teacher <span class="keyword">values</span>(v_id, v_name, v_sex, v_birth, v_educ, v_profess, v_dept_id);</span><br><span class="line">      dbms_output.put_line(<span class="string">&#x27;教师信息添加成功！&#x27;</span>);</span><br><span class="line">      <span class="keyword">commit</span>;</span><br><span class="line">    <span class="keyword">end</span> if;</span><br><span class="line">    </span><br><span class="line">    exception</span><br><span class="line">      <span class="keyword">when</span> ex_null <span class="keyword">then</span> </span><br><span class="line">        dbms_output.put_line(<span class="string">&#x27;输入不能为空噢！&#x27;</span>);</span><br><span class="line">      <span class="keyword">when</span> ex_dept_no_exist <span class="keyword">then</span> </span><br><span class="line">        dbms_output.put_line(<span class="string">&#x27;系部代码不存在！&#x27;</span>);</span><br><span class="line">      <span class="keyword">when</span> dup_val_on_index <span class="keyword">then</span></span><br><span class="line">        dbms_output.put_line(<span class="string">&#x27;该教师已存在&#x27;</span>);</span><br><span class="line">      <span class="keyword">when</span> others <span class="keyword">then</span></span><br><span class="line">        dbms_output.put_line(<span class="string">&#x27;未知异常!&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> teacher;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试1：输入参数为null</span></span><br><span class="line"><span class="comment">-- 测试2：系部代码不存在</span></span><br><span class="line"><span class="comment">-- 测试3：输入已存在的教师</span></span><br><span class="line"><span class="comment">-- 测试4：未知异常</span></span><br><span class="line"><span class="comment">-- 测试5：性别输入不正确</span></span><br><span class="line"><span class="comment">-- 测试6：正常执行</span></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 创建存储过程pro_StudentsNotUpToStandar</span></span><br><span class="line"><span class="comment">-- 存储过程pro_StudentsNotUpToStandar的程序框架如下：</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> pro_StudentsNotUpToStandar</span><br><span class="line">(p_deptID varchar2,p_standerCredit number)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">  <span class="comment">-- 定义形参为null时抛出的用户自定义异常变量	</span></span><br><span class="line">  <span class="comment">-- 定义根据形参部门代码查询指定系部所有学生信息的游标1;		</span></span><br><span class="line">  <span class="comment">-- 定义保存学生所有学分的变量	</span></span><br><span class="line">  <span class="comment">-- 定义保存当前学生编号变量	</span></span><br><span class="line">  <span class="comment">-- 定义根据当前学生编号查询学生所有选修课程信息及学生成绩的游标2;</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">-- 如果形参有为null的情况，</span></span><br><span class="line">  			<span class="comment">-- 抛出用户自定义异常；</span></span><br><span class="line">  <span class="comment">-- 循环遍历游标1，完成以下任务：</span></span><br><span class="line">		<span class="comment">-- 查询当前学生获得的所有学分；</span></span><br><span class="line">		<span class="comment">-- 如果学生的总学分小于形参给出的达标学分，就完成以下任务：</span></span><br><span class="line">			<span class="comment">-- 首先输出学生的信息；</span></span><br><span class="line">			<span class="comment">-- 然后遍历游标2 </span></span><br><span class="line">				<span class="comment">-- 输出学生选修的所有课程信息</span></span><br><span class="line">  EXCEPTION</span><br><span class="line">    <span class="comment">-- 处理用户自定义异常 </span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- lab2</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">procedure</span> pro_StudentsNotUpToStandar</span><br><span class="line">(p_deptID varchar2, p_standerCredit number)</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">null_error exception;</span><br><span class="line"><span class="keyword">cursor</span> c1 <span class="keyword">is</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> dept_id <span class="operator">=</span> p_deptID;</span><br><span class="line">total_credit number(<span class="number">3</span>);</span><br><span class="line">temp_cur_stuid varchar2(<span class="number">20</span>);</span><br><span class="line"><span class="keyword">cursor</span> c2 <span class="keyword">is</span> <span class="keyword">select</span> courses.<span class="operator">*</span>,sc.grade <span class="keyword">from</span> sc,courses <span class="keyword">where</span> sc.course_id <span class="operator">=</span> courses.course_id <span class="keyword">and</span> sc.student_id <span class="operator">=</span> temp_cur_stuid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">    if p_deptID <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> p_standerCredit <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> </span><br><span class="line">      raise null_error; </span><br><span class="line">    <span class="keyword">end</span> if;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c1 loop</span><br><span class="line">      <span class="keyword">select</span> i.student_id <span class="keyword">into</span> temp_cur_stuid <span class="keyword">from</span> dual;</span><br><span class="line">      <span class="keyword">select</span> <span class="built_in">sum</span>(courses.credits) <span class="keyword">into</span> total_credit <span class="keyword">from</span> sc,courses <span class="keyword">where</span> sc.course_id <span class="operator">=</span> courses.course_id <span class="keyword">and</span> sc.grade <span class="operator">&gt;=</span> <span class="number">60</span> <span class="keyword">and</span> sc.student_id <span class="operator">=</span> i.student_id;</span><br><span class="line">      if total_credit <span class="operator">&lt;</span> p_standerCredit <span class="keyword">then</span></span><br><span class="line">          dbms_output.put_line(i.student_id <span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>i.sname<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>i.ssex<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>i.sbirth<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>i.nationality<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>i.class_id<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>i.dept_id);</span><br><span class="line">      <span class="keyword">for</span> i <span class="keyword">in</span> c2 loop</span><br><span class="line">        dbms_output.put_line(i.course_id<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>i.cname<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>i.credits<span class="operator">||</span><span class="string">&#x27; &#x27;</span><span class="operator">||</span>i.grade);</span><br><span class="line">      <span class="keyword">end</span> loop;</span><br><span class="line">      <span class="keyword">end</span> if;</span><br><span class="line">    <span class="keyword">end</span> loop;</span><br><span class="line">    exception </span><br><span class="line">      <span class="keyword">when</span> null_error <span class="keyword">then</span> dbms_output.put_line(<span class="string">&#x27;过程输入参数均不能为空！&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">-- 测试1：当学分为null</span></span><br><span class="line"><span class="keyword">call</span> pro_StudentsNotUpToStandar(<span class="string">&#x27;081&#x27;</span>,<span class="keyword">null</span>);</span><br><span class="line"><span class="comment">-- 测试2：指定系部为null</span></span><br><span class="line"><span class="keyword">call</span> pro_StudentsNotUpToStandar(<span class="keyword">null</span>,<span class="number">20</span>);</span><br><span class="line"><span class="comment">-- 测试3：正常输入</span></span><br><span class="line"><span class="keyword">call</span> pro_StudentsNotUpToStandar(<span class="string">&#x27;081&#x27;</span>,<span class="number">20</span>);</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Oracle</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>创建SpringBoot项目的三种方法</title>
    <url>/2021/10/23/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/</url>
    <content><![CDATA[<h3 id="SpringBoot的介绍"><a href="#SpringBoot的介绍" class="headerlink" title="SpringBoot的介绍"></a>SpringBoot的介绍</h3><p>上javaweb课程的时候，使用Servlet/JSP做开发，一个接口就需要搞一个Servlet，使用很不方便；后来引入了SpringMVC一类的框架，提高了生产力，但是用久了，发现了新问题，即配置繁琐易出错；如果想做一个新项目，需要先搭环境，环境也就是那几行配置，不同的项目可能只有包不同，其他部分的配置都是一样的，Java总背诟病配置繁琐代码量巨大（我学习了golang之后发现go真的太香了），那怎么办呢？Spring Boot应运而生，主要提供了如下功能</p>
<ol>
<li><p>为所有基于Spring的Java开发提供了方便快捷的入门体验</p>
</li>
<li><p>开箱即用，有自己的自定义配置的话用自己的，没有的话用官方自带的即可</p>
</li>
<li><p>提供了一系列通用的非功能性的功能，例如嵌入式服务器、安全管理、健康检测等</p>
</li>
<li><p>绝对没有代码生成，也不需要XML配置</p>
</li>
</ol>
<h3 id="SpringBoot系统要求"><a href="#SpringBoot系统要求" class="headerlink" title="SpringBoot系统要求"></a>SpringBoot系统要求</h3><p>至少要求JDK8，内置的Tomcat版本是9.0</p>
<h3 id="SpringBoot项目的三种创建方式"><a href="#SpringBoot项目的三种创建方式" class="headerlink" title="SpringBoot项目的三种创建方式"></a>SpringBoot项目的三种创建方式</h3><h4 id="在线创建"><a href="#在线创建" class="headerlink" title="在线创建"></a>在线创建</h4><p>这个是官方推荐的创建方式，实际上我们使用IEDA创建SpringBoot项目(第二种方式),也就是从这个网站上或者其他网站上创建的，只不过开发工具帮我们完成了这个过程。</p>
<p>首先打开 <a href="https://start.spring.io/">https://start.spring.io</a>这个网站，如下图：</p>
<p><img src="1.1.png"></p>
<p>配置简单说明：</p>
<ul>
<li><p>构建工具是Maven还是Gradle，我这里选择创建Maven项目</p>
</li>
<li><p>开发语言，这个当然选择Java</p>
</li>
<li><p>SpringBoot 版本，可以看到目前的最新稳定版是2.5.6，所以我这里选择最新稳定版</p>
</li>
<li><p>既然是Maven工程，当然得用项目坐标、项目描述等信息，另外这里还需要输入包名，因为创建成功后会自动生成启动类</p>
</li>
<li><p>Packing表示项目要打包成jar包还是war包，SpringBoot的一大优势就是内嵌了Servlet容器，所以打成jar包可以直接运行。当然也可以更具实际情况选择war包</p>
</li>
<li><p>选择构建的JDK版本</p>
</li>
<li><p>选择需要的依赖，输入关键字比如说web，会有相关的提示，这里我先加入web依赖</p>
</li>
</ul>
<p>所有的事情都完成后，点击下方的<strong>generate</strong>按钮或者快捷键Alt+Enter，将下载下来的项目解压，然后用IDEA打开即可。</p>
<h4 id="使用开发工具创建"><a href="#使用开发工具创建" class="headerlink" title="使用开发工具创建"></a>使用开发工具创建</h4><p>有人觉得使用第一种方式创建项目过于繁琐，那么可以使用开发工具来创建。需要注意的是IDEA只有ultimate版才能创建SpringBoot项目，社区版无此功能。<strong>学生可以通过教育邮箱免费白嫖</strong></p>
<p>首先，在创建项目的时候选择<strong>Spring Initializr</strong></p>
<p><img src="1-2.png"></p>
<p>然后点击Next，填入Maven项目的基本信息</p>
<p><img src="1-3.png"></p>
<p>选择依赖</p>
<p><img src="1-4.png"></p>
<p>完成创建</p>
<h4 id="使用Maven创建"><a href="#使用Maven创建" class="headerlink" title="使用Maven创建"></a>使用Maven创建</h4><p>上面提到的创建SpringBoot项目的方式都借助到了<strong><a href="https://start.spring.io/">https://start.spring.io/</a></strong> 这个网站；有时候网站不会很稳定，会出现项目创建失败的情况，所以这个时候可以选择通过Maven来创建项目。步骤如下</p>
<p>首先创建一个普通的Maven项目</p>
<p><img src="1-5.png"></p>
<p>注意这里不用选择项目骨架（如果大伙是做练习的话，也可以去尝试选择一下，这里大概有十来个 Spring Boot 相关的项目骨架），直接点击 Next ，下一步中填入一个 Maven 项目的基本信息，如下图：</p>
<p><img src="1-6.png"></p>
<p>然后点击Next完成项目的创建。</p>
<p>创建完成之后，在pom.xml文件下，添加如下依赖</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;parent&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.1.4.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/parent&gt;</span><br><span class="line">&lt;dependencies&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>

<p>添加成功之后，在Java目录中创建包，编写启动类，这边参考松哥的启动类</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@EnableAutoConfiguration</span><br><span class="line">@RestController</span><br><span class="line">public class App &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(App.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">    @GetMapping(&quot;/hello&quot;)</span><br><span class="line">    public String hello() &#123;</span><br><span class="line">        return &quot;hello&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>@EnableAutoConfiguration注解表示开启自动化配置</strong></p>
<p>接下来执行main方法就可以启动一个SpringBoot项目了</p>
<p>项目结构(参考松哥)：</p>
<p><img src="1-7.png"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>以上就是常用的创建SringBoot项目的方式，随着我的学习，如果有更好的创建方式会分享给大家。</p>
]]></content>
      <categories>
        <category>SpringBoot</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
      </tags>
  </entry>
  <entry>
    <title>Maven工程的resource结点的理解</title>
    <url>/2021/10/23/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02/</url>
    <content><![CDATA[<p>当我们使用Mybatis的时候，mapper文件想要在包中被解析，就需要配置resource</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">      &lt;resource&gt;</span><br><span class="line">        &lt;directory&gt;$&#123;basedir&#125;/src/main/resources&lt;/directory&gt;</span><br><span class="line">        &lt;filtering&gt;true&lt;/filtering&gt;</span><br><span class="line">        &lt;includes&gt;</span><br><span class="line">          &lt;include&gt;**/application*.yml&lt;/include&gt;</span><br><span class="line">          &lt;include&gt;**/application*.yaml&lt;/include&gt;</span><br><span class="line">          &lt;include&gt;**/application*.properties&lt;/include&gt;</span><br><span class="line">        &lt;/includes&gt;</span><br><span class="line">      &lt;/resource&gt;</span><br><span class="line">      &lt;resource&gt;</span><br><span class="line">        &lt;directory&gt;$&#123;basedir&#125;/src/main/resources&lt;/directory&gt;</span><br><span class="line">        &lt;excludes&gt;</span><br><span class="line">          &lt;exclude&gt;**/application*.yml&lt;/exclude&gt;</span><br><span class="line">          &lt;exclude&gt;**/application*.yaml&lt;/exclude&gt;</span><br><span class="line">          &lt;exclude&gt;**/application*.properties&lt;/exclude&gt;</span><br><span class="line">        &lt;/excludes&gt;</span><br><span class="line">      &lt;/resource&gt;</span><br><span class="line">    &lt;/resources&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>resources中可以有多个resource</li>
<li>directory 指定资源目录</li>
<li>includes中可以有多个include</li>
<li>**/application*.yml中最后一个*代表通配符，因为你可能会有-dev -test等等的profile</li>
</ul>
<h4 id="include代表需要这些文件，exclude代表除去这些文件，那你到底是想包括这些文件还是想除去这些文件呢？"><a href="#include代表需要这些文件，exclude代表除去这些文件，那你到底是想包括这些文件还是想除去这些文件呢？" class="headerlink" title="include代表需要这些文件，exclude代表除去这些文件，那你到底是想包括这些文件还是想除去这些文件呢？"></a>include代表需要这些文件，exclude代表除去这些文件，那你到底是想包括这些文件还是想除去这些文件呢？</h4><p>上下两个配置唯一的差别就在<filtering>true</filtering>中，所以关键就在这。</p>
<p>下面是松哥的一个简单案例</p>
<p>新建两个properties文件,a.properties和b.properties，两个文件分别写入a.name=wr1sw和b.name=wr1sw</p>
<p><img src="1-1.png"></p>
<p>接下来使用maven工具package给项目打一个包，会发现classes中出现了这两个配置文件</p>
<p>在pom.xml中定义一些变量,变量是可以在properties文件中引用的，应用方式就是${wr1sw.name},当项目在编译打包的时候会自动替换变量值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">        &lt;wr1sw.name&gt;wr1sw&lt;/wr1sw.name&gt;</span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure>

<p>但是，直接打包的话，properties文件中的变量并没有变，这就涉及到了resource的用法了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">    &lt;resource&gt;</span><br><span class="line">        &lt;directory&gt;src/main/resources&lt;/directory&gt;</span><br><span class="line">        &lt;!--   表示这个东西要进行过滤             --&gt;</span><br><span class="line">        &lt;filtering&gt;true&lt;/filtering&gt;</span><br><span class="line">        &lt;includes&gt;</span><br><span class="line">            &lt;include&gt;a.properties&lt;/include&gt;</span><br><span class="line">        &lt;/includes&gt;</span><br><span class="line">    &lt;/resource&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure>
<p>加上这行会发现，a.properties中的变量成功能显示了，但是b.properties缺不见了;</p>
<p>如果你没有指定的话，resources下的配置文件都会被编译，如果你指定了，就会按照你指定的来。</p>
<p>如果说我现在不想忽略其他文件(b.properties)，我没有必要在include中加上b.properties，因为在b.properties里面没有需要引用pom.xml里的变量。这个时候可以定义一个exclude,含义是：<br><strong>除了a.properties的文件，其他文件呢会给你保留下来，但是呢其他文件不会进行一个过滤的处理，因为其他文件里面也没有需要处理的(没有引用变量)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">    &lt;resource&gt;</span><br><span class="line">        &lt;directory&gt;src/main/resources&lt;/directory&gt;</span><br><span class="line">        &lt;!--   表示这个东西要进行过滤             --&gt;</span><br><span class="line">        &lt;filtering&gt;true&lt;/filtering&gt;</span><br><span class="line"></span><br><span class="line">        &lt;includes&gt;</span><br><span class="line">            &lt;include&gt;a.properties&lt;/include&gt;</span><br><span class="line">        &lt;/includes&gt;</span><br><span class="line">    &lt;/resource&gt;</span><br><span class="line">    &lt;resource&gt;</span><br><span class="line">        &lt;directory&gt;src/main/resources&lt;/directory&gt;</span><br><span class="line">            &lt;!--     默认就是false,这里写false是因为其他文件没有用到pom.xml的变量，没有必要过滤处理           --&gt;</span><br><span class="line">        &lt;filtering&gt;false&lt;/filtering&gt;</span><br><span class="line">        &lt;excludes&gt;</span><br><span class="line">            &lt;exclude&gt;a.properties&lt;/exclude&gt;</span><br><span class="line">        &lt;/excludes&gt;</span><br><span class="line">    &lt;/resource&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>SpringBoot</category>
        <category>Maven</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
      </tags>
  </entry>
  <entry>
    <title>Spring Boot 项目中的 parent</title>
    <url>/2021/10/23/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B03/</url>
    <content><![CDATA[<p>以下是学习松哥的SpringBoot的学习笔记</p>
<h3 id="你真的了解SpringBoot中的parent吗？"><a href="#你真的了解SpringBoot中的parent吗？" class="headerlink" title="你真的了解SpringBoot中的parent吗？"></a>你真的了解SpringBoot中的parent吗？</h3><p>在上一篇博客中写到了SpringBoot项目的创建方式，这几种创建方式无论哪一种，创建项目成功之后，pom.xml坐标文件中都会有如下一段引用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;parent&gt;</span><br><span class="line">       &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">       &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">       &lt;version&gt;2.5.6&lt;/version&gt;</span><br><span class="line">       &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">&lt;/parent&gt;</span><br><span class="line">   </span><br></pre></td></tr></table></figure>

<h4 id="基本功能"><a href="#基本功能" class="headerlink" title="基本功能"></a>基本功能</h4><p>当我们创建一个SpringBoot项目的时，可以继承一个<strong>spring-boot-starter-parent</strong>，当然也可以不继承它。我们先来看看parent的基本功能有哪些？</p>
<ol>
<li>定义了Java编译版本为1.8</li>
<li>使用UTF-8格式编码</li>
<li>继承自<strong>spring-boot-dependencies</strong>，这个里面定义了依赖的版本，正因为继承了这个依赖，所以我们在写依赖的时候才不需要写版本号</li>
<li>执行打包操作的配置</li>
<li>自动化的资源过滤</li>
<li>自动化的插件配置</li>
<li>针对 application.properties 和 application.yml 的资源过滤，包括通过 profile 定义的不同环境的配置文件，例如 application-dev.properties 和 application-dev.yml</li>
</ol>
<p><strong>请注意，由于application.properties和application.yml文件接受Spring样式占位符 $ {…} ，因此 Maven 过滤更改为使用 @ .. @ 占位符，当然开发者可以通过设置名为 resource.delimiter 的Maven 属性来覆盖 @ .. @ 占位符。</strong></p>
<h4 id="源码分析"><a href="#源码分析" class="headerlink" title="源码分析"></a>源码分析</h4><p>当我们创建一个 Spring Boot 项目后，我们可以在本地 Maven 仓库中看到看到这个具体的 parent 文件，以 2.1.4 这个版本为例,图片引用松哥。</p>
<p><img src="1-1.png"></p>
<p>我们可以看到，它继承自 spring-boot-dependencies ，这里保存了基本的依赖信息，另外我们也可以看到项目的编码格式，JDK 的版本等信息，当然也有我们前面提到的数据过滤信息。最后，我们再根据它的 parent 中指定的 spring-boot-dependencies 位置，来看看 spring-boot-dependencies 中的定义：</p>
<p><img src="1-2.png"></p>
<p>在这里，我们看到了版本的定义以及 dependencyManagement 节点，明白了为啥 Spring Boot 项目中部分依赖不需要写版本号了</p>
]]></content>
      <categories>
        <category>SpringBoot</category>
        <category>Maven</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringBoot的web容器基本配置</title>
    <url>/2021/10/23/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B04/</url>
    <content><![CDATA[<p>我们都知道SpringBoot中内嵌了一个Tomcat中可以直接使用。</p>
]]></content>
      <categories>
        <category>SpringBoot</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2021/10/21/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>oracle复习1</title>
    <url>/2021/11/11/oracle%E5%A4%8D%E4%B9%A01/</url>
    <content><![CDATA[<h4 id="1-Oracle常用工具及默认用户"><a href="#1-Oracle常用工具及默认用户" class="headerlink" title="1. Oracle常用工具及默认用户"></a>1. Oracle常用工具及默认用户</h4><h4 id="1-1-常用工具"><a href="#1-1-常用工具" class="headerlink" title="1.1 常用工具"></a>1.1 常用工具</h4><h5 id="1-1-1-常用系统管理工具"><a href="#1-1-1-常用系统管理工具" class="headerlink" title="1.1.1 常用系统管理工具"></a>1.1.1 常用系统管理工具</h5><ul>
<li>数据库配置助手（<strong>DataBase Configuration Assistant</strong>，简称DBCA）是Oracle提供的一种图形化管理工具，能够：</li>
</ul>
<ol>
<li><p>创建数据库</p>
</li>
<li><p>配置数据库选项</p>
</li>
<li><p>删除数据库</p>
</li>
<li><p>管理数据库模板</p>
</li>
</ol>
<ul>
<li><p>网络配置助手(<strong>OracleNet Configuration Assistant</strong> 简称ONCA)： </p>
<ol>
<li><p>监听程序配置</p>
</li>
<li><p>本地网络服务配置 </p>
</li>
</ol>
</li>
</ul>
<h5 id="1-1-2-常用数据库管理工具"><a href="#1-1-2-常用数据库管理工具" class="headerlink" title="1.1.2  常用数据库管理工具"></a>1.1.2  常用数据库管理工具</h5><ul>
<li><p>SQLPlus工具的使用</p>
<ol>
<li><p>方法一：通过开始 菜单“SQL Plus” 。</p>
</li>
<li><p>方法二：通过DOS命令</p>
</li>
</ol>
</li>
</ul>
<p>点击“开始”—&gt;“运行”—&gt;输入“cmd命令”—&gt;进入DOS环境下执行SQLPLUS命令也可以打开SQL*Plus工具。</p>
<p>◦（1）SQLPLUS [用户名]/[密码][@主机字符串][AS SYSDBA|SYSOPER] </p>
<p>◦（2）SQLPLUS 用户名/密码@主机名|主机IP地址: 端口号/数据库实例名 [AS SYSDBA|SYSOPER]</p>
<ul>
<li>SQL Developer</li>
</ul>
<p><strong>SQL Develope</strong>r允许用户创建并维护数据库对象，查看和维护数据，编写、维护并调试PL/SQL代码。这款工具以其简洁整齐的图形用户界面大大简化了开发工作。</p>
<p><strong>注意</strong>：如果Oracle SQL Developer的SQL工作表不能正常编辑,无法使用回车键,上下左右键:</p>
<p><strong>打开菜单并选择 工具-首选项-加速器-加载预设-Default</strong></p>
<hr>
<h4 id="1-2-默认用户"><a href="#1-2-默认用户" class="headerlink" title="1.2 默认用户"></a>1.2 <strong>默认用户</strong></h4><p>SYS：该用户被默认创建并授予DBA角色，它是Oracle数据库中权限最大的管理员账号。</p>
<p>SYSTEM：被默认创建并授予DBA角色权限仅次于SYS。该用户创建和管理数据库中可显示管理信息的表或视图，以及被Oracle数据库应用和工具使用的各种数据库对象。</p>
<p>SYSMAN：该用户是企业管理的超级管理员账号，该账号能够创建和修改其他管理员账号，同时也能管理数据库实例。</p>
<p>DBSNMP：是Oracle数据库中用于智能代理（Intelligent Agent）的用户，用来监控和管理数据库相关性能。如果停止该用户，则无法提取相关的数据库信息。</p>
<hr>
<p>例1.2 以system用户登录数据库。</p>
<p>​    ◦ SQLPLUS </p>
<p>​    ◦ SQLPLUS system </p>
<p>​    ◦ SQLPLUS system/abcdef </p>
<p>​    ◦ SQLPLUS system/abcdef@orcl</p>
<p>例1.3 以sys用户登录数据库。</p>
<p>​    ◦SQLPLUS sys/abcdef AS SYSDBA </p>
<p>​    ◦SQLPLUS sys/abcdef@orcl AS SYSOPER</p>
<p>例1.4 不使用已定义的主机字符串，直接指定要连接的主机名、端口号和数据库实例。</p>
<p>​    ◦SQLPLUS system/abcdef@localhost:1521/orcl </p>
<p>例1.5 在SQL*Plus环境下，使用CONNECT命令将当前用户分别切换到system用户或sys用户。</p>
<p>​    CONNECT system/abcdef@orcl</p>
<p>​    CONNECT sys/abcdef@orcl as sysdba</p>
<h4 id="1-3-Oracle体系结构"><a href="#1-3-Oracle体系结构" class="headerlink" title="1.3 Oracle体系结构"></a>1.3 Oracle体系结构</h4><h5 id="1-3-1-物理存储结构"><a href="#1-3-1-物理存储结构" class="headerlink" title="1.3.1 物理存储结构"></a>1.3.1 物理存储结构</h5><p>概念：Oracle数据库的物理存储结构是从物理组成的角度分析一个数据库在存储介质上的实际构成，它是由操作系统组织和管理的，是Oracle数据库的外部存储结构。</p>
<p>Oracle数据库主要包括4种类型的文件：</p>
<ul>
<li>数据文件</li>
<li>日志文件</li>
<li>控制文件</li>
<li>初始化参数</li>
</ul>
<h4 id="1-3-2-逻辑存储结构"><a href="#1-3-2-逻辑存储结构" class="headerlink" title="1.3.2 逻辑存储结构"></a>1.3.2 逻辑存储结构</h4><p>概念：在逻辑上定义了一组存储单元，以逐层细分的思想将数据库对象占用的存储空间依次划分为表空间、段、盘区和数据块。</p>
<ul>
<li>表空间是最大的逻辑存储单元，一个数据库从逻辑结构上划分就包括多个表空间；</li>
<li>一个表空间继续划分为多个段；</li>
<li>一个段又被划分为多个盘区，盘区是最小的磁盘空间分配单元；</li>
<li>一个盘区又被划分为多个数据块，数据块是Oracle最小的数据读写单元。</li>
<li>表空间（tablespace）是Oracle数据库中最大的逻辑存储结构 。</li>
<li>逻辑结构上的表空间与物理结构上的数据文件是有关联的。这种关联是：</li>
<li>数据库中的一个表空间至少包含一个或多个数据文件，而一个数据文件只能属于一个表空间。</li>
<li>一个表空间的大小就等于它包含的所有数据文件大小之和。 </li>
</ul>
<p><img src="1-1.png"></p>
<p><img src="2-2.png"></p>
]]></content>
      <categories>
        <category>Oracle</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title>孤独</title>
    <url>/2021/10/21/%E5%AD%A4%E7%8B%AC/</url>
    <content><![CDATA[<h3 id="什么是孤独？"><a href="#什么是孤独？" class="headerlink" title="什么是孤独？"></a>什么是孤独？</h3><p>什么是孤独呢？可能就是离2021/10/22日还剩下3分钟了，而你还没回复我的消息；<br>-礼物已经买好，礼物已经送到，但是缺了一个主人。</p>
]]></content>
  </entry>
  <entry>
    <title>结束啦</title>
    <url>/2021/10/22/%E7%BB%93%E6%9D%9F%E5%95%A6/</url>
    <content><![CDATA[<h3 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h3><p>纠结了很久，还是决定在你生日那天挣扎一下；估计你也能从一些空间的小细节能看出来吧；仔细想来，长那么大，第一次收到真正意义上的好人卡，感觉还是有点奇怪；<br>脸，会很热会热；心，真的会跳的蛮快的；脑子，确实是有那么一点点蒙蒙的感觉。可能，对这个结果早就预想到了，并没有多难受吧；刚才打开的是王道考研的视频，一直都没下定决心要不要考研。可能，这也是冥冥之中自有天意吧。</p>
<p>有人在骗自己，听了一晚上房东的猫；有人在骗自己，她不玩qq了看不到信息；有人在骗自己，他并没有多难受；那只熊猫就让他在北京留着吧。</p>
]]></content>
  </entry>
  <entry>
    <title>老坛酸菜</title>
    <url>/2021/10/23/%E8%80%81%E5%9D%9B%E9%85%B8%E8%8F%9C/</url>
    <content><![CDATA[<h4 id="有感个鸡毛，什么都没听；吃了一个会议的酸菜，聊你妈聊你妈聊你妈聊你妈；"><a href="#有感个鸡毛，什么都没听；吃了一个会议的酸菜，聊你妈聊你妈聊你妈聊你妈；" class="headerlink" title="有感个鸡毛，什么都没听；吃了一个会议的酸菜，聊你妈聊你妈聊你妈聊你妈；"></a>有感个鸡毛，什么都没听；吃了一个会议的酸菜，聊你妈聊你妈聊你妈聊你妈；</h4>]]></content>
  </entry>
  <entry>
    <title>软件制造工程复习</title>
    <url>/2021/11/17/%E8%BD%AF%E4%BB%B6%E5%88%B6%E9%80%A0%E5%B7%A5%E7%A8%8B%E5%A4%8D%E4%B9%A0/</url>
    <content><![CDATA[<h2 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h2><h3 id="软件危机"><a href="#软件危机" class="headerlink" title="软件危机"></a>软件危机</h3><ul>
<li>软件危机是指在计算机软件的开发和维护过程中所遇到的一系列严重问题</li>
</ul>
<h3 id="软件工程"><a href="#软件工程" class="headerlink" title="软件工程"></a>软件工程</h3><ul>
<li>软件工程：是指导计算机软件开发和维护的一门工程学科。</li>
</ul>
<ul>
<li><p>软件工程的概念是哪一年提出的？<strong>1968年</strong></p>
</li>
<li><p>瀑布模型的关键不足在于：<strong>不能适应需求的动态变更</strong></p>
</li>
<li><p>软件可行性研究实质上是要进行一次<strong>简化、压缩的</strong>需求分析和设计过程</p>
</li>
<li><p>软件制造工程活动主要关注<strong>编码</strong>，也包括详细设计、单元测试</p>
</li>
<li><p>结构化设计是一种<strong>面向数据流</strong>的设计方法</p>
</li>
<li><p>一个项目是否开发,从经济上来说是否可行,归根结底是取决于对<strong>成本的估算</strong></p>
</li>
<li><p>在面向对象的设计中，我们应遵循的设计准则除了模块化、抽象、低耦合、高内聚以外，还有<strong>信息隐蔽</strong></p>
</li>
<li></li>
</ul>
<h3 id="软件生命周期"><a href="#软件生命周期" class="headerlink" title="软件生命周期"></a>软件生命周期</h3><p><img src="1.png"></p>
<h2 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h2><h2 id="第三章"><a href="#第三章" class="headerlink" title="第三章"></a>第三章</h2><h4 id="创建类的原因"><a href="#创建类的原因" class="headerlink" title="创建类的原因"></a>创建类的原因</h4><ul>
<li>为现实世界中的对象建模</li>
<li>为抽象的对象建模</li>
<li>降低复杂度</li>
<li>隔离复杂度</li>
<li>隐藏实现细节</li>
<li>限制变动的影响范围</li>
<li>隐藏全局数据</li>
<li>让参数传递更顺畅</li>
<li>建立中心控制点</li>
<li>让代码更易于重用</li>
<li>为程序族做计划</li>
<li>把相关操作包装到一起</li>
<li>实现某种特定的重构</li>
</ul>
<h4 id="命名的基本原则"><a href="#命名的基本原则" class="headerlink" title="命名的基本原则"></a>命名的基本原则</h4><ul>
<li><p>名字应能反映它所代表的实际东西，应有一定实际意义</p>
</li>
<li><p>使用可以准确说明变量/字段/类/接口/包等的完整的英文描述符</p>
</li>
<li><p>采用该领域的术语</p>
</li>
<li><p>采用大小写混合，提高名字的可读性</p>
</li>
<li><p>尽量少用缩写</p>
</li>
<li><p>避免使用长名字</p>
</li>
<li><p>避免使用相似或者仅在大小写上有区别的名字</p>
</li>
</ul>
<h4 id="四种编程命名规范"><a href="#四种编程命名规范" class="headerlink" title="四种编程命名规范"></a>四种编程命名规范</h4><ul>
<li>匈牙利命名法</li>
<li>驼峰式命名法</li>
<li>帕斯卡命名法</li>
<li>下划线命名法</li>
</ul>
<h4 id="版本控制的好处"><a href="#版本控制的好处" class="headerlink" title="版本控制的好处"></a>版本控制的好处</h4><ul>
<li>便于团队代码共享</li>
<li>保证整个团队使用统一的代码版本</li>
<li>能获得版本控制工具中保存的任何版本</li>
<li>能够把出错或误操作的最新版的项目恢复到正确的历史版本</li>
<li>快速的集成</li>
</ul>
<h4 id="异常的概念"><a href="#异常的概念" class="headerlink" title="异常的概念"></a>异常的概念</h4><ul>
<li>异常是指把代码中的错误或异常事件传递给调用方代码的一种特殊手段</li>
</ul>
<p>异常的基本结构</p>
<ul>
<li>子程序使用throw抛出一个异常对象，在被调用链上层其他子程序的try-catch语句捕获</li>
</ul>
<h4 id="防御式编程"><a href="#防御式编程" class="headerlink" title="防御式编程"></a>防御式编程</h4><ul>
<li>防御式编程的主要思想是：子程序不因传入错误数据而被破坏，哪怕是由其它子程序产生的错误数据</li>
<li>其核心是承认程序内部都会有问题，都需要被修改，这是保护的基础</li>
<li>防御式编程是针对程序外部的保护</li>
</ul>
<ol>
<li>保护程序免遭非法输入数据的破坏</li>
<li>断言</li>
<li>错误处理</li>
<li>异常</li>
<li>隔离程序</li>
<li>辅助调试代码</li>
</ol>
<h2 id="第四章"><a href="#第四章" class="headerlink" title="第四章"></a>第四章</h2><ul>
<li><p>软件测试是为了<strong>发现错误</strong>而执行程序的过程</p>
</li>
<li><p>模块并不是一个独立的程序，因此必须为每个单元测试开发<strong>驱动程序</strong>和<strong>存根程序</strong></p>
</li>
</ul>
<h2 id="第五章"><a href="#第五章" class="headerlink" title="第五章"></a>第五章</h2><h4 id="软件维护的定义"><a href="#软件维护的定义" class="headerlink" title="软件维护的定义"></a>软件维护的定义</h4><ul>
<li>所谓软件维护就是在软件已经交付使用之后，为了改正错误或满足新的需求而修改软件的过程</li>
</ul>
<p>可分为4项活动：</p>
<ul>
<li><strong>改正性维护</strong>：把诊断和改正错误的过程称为改正性维护   17%~21%</li>
<li><strong>适应性维护</strong>：为了和变化了的环境适当地配合而进行的<strong>修改软件</strong>的活动，是既必要又经常的维护活动。   18%~25%</li>
<li><strong>完善性维护</strong>：为了满足用户提出的增加新功能或修改已有功能的要求和一般性的改进要求  50%~66%</li>
<li><strong>预防性维护</strong>：为了改善未来的可维护性或可靠性而修改软件的工作    4%</li>
</ul>
<h4 id="决定软件可维护性的因素"><a href="#决定软件可维护性的因素" class="headerlink" title="决定软件可维护性的因素"></a>决定软件可维护性的因素</h4><ul>
<li>可理解性</li>
<li>可测试性</li>
<li>可修改性</li>
<li>可靠性</li>
<li>可移植性</li>
<li>可使用性</li>
<li>效率</li>
</ul>
<h4 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h4><ul>
<li><p>因计算机硬件和软件环境的变化而作出的修改软件的过程称为<strong>适应性维护</strong></p>
</li>
<li><p>下列属于维护阶段的文档是 <strong>软件问题报告</strong></p>
</li>
<li><p>软件按照设计的要求，在规定的时间内和条件下达到不出故障，持续运行的要求的质量特性成为<strong>可靠性</strong></p>
</li>
<li><p><strong>确认测试</strong>又称有效性测试。验证软件的<strong>功能、性能及其它特性</strong>是否与<strong>用户的要求</strong>一致</p>
</li>
<li></li>
</ul>
]]></content>
      <categories>
        <category>软件工程</category>
      </categories>
      <tags>
        <tag>学习</tag>
        <tag>导航</tag>
        <tag>软件工程</tag>
      </tags>
  </entry>
  <entry>
    <title>软件工程导论</title>
    <url>/2021/10/21/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E5%AF%BC%E8%AE%BA/</url>
    <content><![CDATA[<h5 id="1-软件工程是从管理和技术两方面研究如何更好地开发维护计算机软件的一门新兴学科。（软件工程是指导计算机软件开发和维护的一门工程学科）"><a href="#1-软件工程是从管理和技术两方面研究如何更好地开发维护计算机软件的一门新兴学科。（软件工程是指导计算机软件开发和维护的一门工程学科）" class="headerlink" title="1. 软件工程是从管理和技术两方面研究如何更好地开发维护计算机软件的一门新兴学科。（软件工程是指导计算机软件开发和维护的一门工程学科）"></a>1. 软件工程是从管理和技术两方面研究如何更好地开发维护计算机软件的一门新兴学科。（软件工程是指导计算机软件开发和维护的一门工程学科）</h5><h5 id="软件危机具体表现："><a href="#软件危机具体表现：" class="headerlink" title="软件危机具体表现："></a>软件危机具体表现：</h5><ul>
<li>对软件开发成本和进度估计常常很不准确</li>
<li>软件产品的质量往往靠不住</li>
<li>软件常常是不可维护的</li>
<li>软件通常没有适当的文档资料</li>
<li>用户对已完成的软件系统不满意现象经常发生</li>
<li>软件成本在计算机系统总成本中所占比例逐年上升</li>
<li>软件开发生产率提高速度远远更不上计算机应用迅速普及深入的趋势</li>
</ul>
<h5 id="产生软件危机的原因："><a href="#产生软件危机的原因：" class="headerlink" title="产生软件危机的原因："></a>产生软件危机的原因：</h5><ul>
<li>软件本身特点</li>
<li>软件开发维护方法不正确</li>
</ul>
<h5 id="解决软件危机方法：既要有技术措施，又要有必要的组织管理措施。"><a href="#解决软件危机方法：既要有技术措施，又要有必要的组织管理措施。" class="headerlink" title="解决软件危机方法：既要有技术措施，又要有必要的组织管理措施。"></a>解决软件危机方法：既要有技术措施，又要有必要的组织管理措施。</h5><h5 id="软件工程的基本原理"><a href="#软件工程的基本原理" class="headerlink" title="软件工程的基本原理"></a>软件工程的基本原理</h5><ul>
<li>用分阶段的生命周期计划严格管理</li>
<li>坚持进行阶段评审</li>
<li>采用严格的产品控制</li>
<li>采用现代程序设计技术</li>
<li>结果应能清楚的审查</li>
<li>开发的小组成员应该少而精</li>
<li>承认不断改进软件工程实践的必要性</li>
</ul>
<h5 id="方法学（范形）："><a href="#方法学（范形）：" class="headerlink" title="方法学（范形）："></a>方法学（范形）：</h5><ul>
<li>定义：生命周期全过程使用的一整套技术方法的集合</li>
<li>三要素：方法、工具、过程<h5 id="传统方法学也称生命周期方法学或者结构化范型，通过结构化技术完成软件开发各任务。这种方法学把软件生命周期分成各个不同阶段，并一一完成。（对问题抽象分析开始，一个阶段一个阶段顺序开发）"><a href="#传统方法学也称生命周期方法学或者结构化范型，通过结构化技术完成软件开发各任务。这种方法学把软件生命周期分成各个不同阶段，并一一完成。（对问题抽象分析开始，一个阶段一个阶段顺序开发）" class="headerlink" title="传统方法学也称生命周期方法学或者结构化范型，通过结构化技术完成软件开发各任务。这种方法学把软件生命周期分成各个不同阶段，并一一完成。（对问题抽象分析开始，一个阶段一个阶段顺序开发）"></a>传统方法学也称生命周期方法学或者结构化范型，通过结构化技术完成软件开发各任务。这种方法学把软件生命周期分成各个不同阶段，并一一完成。（对问题抽象分析开始，一个阶段一个阶段顺序开发）</h5></li>
</ul>
<h5 id="面向对象方法学四个要点："><a href="#面向对象方法学四个要点：" class="headerlink" title="面向对象方法学四个要点："></a>面向对象方法学四个要点：</h5><ul>
<li>把对象作为融合了数据以及在数据上的操作行为的同意的软件构建</li>
<li>把所有对象划分为类</li>
<li>按照父类（基类）与子类（派生类）的关系，把若干的相关类组成一个层次结构的系统</li>
<li>对象彼此间仅能同各国发送消息互相联系</li>
</ul>
<h5 id="软件生命周期："><a href="#软件生命周期：" class="headerlink" title="软件生命周期："></a>软件生命周期：</h5><p>组成：软件定义、软件开发、运行维护</p>
<pre><code>软件定义时期三阶段：问题定义、可行性研究、需求分析
</code></pre>
<p>各个阶段：</p>
<ul>
<li>问题定义</li>
<li>可行性研究</li>
<li>需求分析</li>
<li>总体设计</li>
<li>详细设计</li>
<li>编码和单元测试</li>
<li>综合测试</li>
</ul>
<ol>
<li></li>
</ol>
<p>待补充….</p>
]]></content>
      <categories>
        <category>软件工程</category>
      </categories>
      <tags>
        <tag>导航</tag>
        <tag>分享</tag>
      </tags>
  </entry>
</search>
